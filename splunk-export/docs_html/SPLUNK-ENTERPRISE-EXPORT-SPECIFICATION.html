<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMA Splunk Enterprise Export - Specification | Dynatrace Migration Assistant</title>
    <style>
        :root {
            --db-header-bg: #14172b;
            --db-nav-dark: #1a1d2e;
            --db-accent-purple: #7c5dc7;
            --db-accent-blue: #4da6e8;
            --db-accent-green: #6abf4b;
            --content-bg: #ffffff;
            --content-card: #f8f9fa;
            --text-dark: #1a1a2e;
            --text-body: #3a3a4a;
            --text-muted: #6c757d;
            --text-light: #ffffff;
            --accent-blue: #1456ff;
            --success: #6abf4b;
            --border-light: #e0e0e0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.45;
            color: var(--text-dark);
            background: var(--content-bg);
            font-size: 14px;
        }

        /* Header - Compact */
        .header-banner {
            background: var(--db-header-bg);
            padding: 20px 16px;
            text-align: center;
        }
        .header-content { max-width: 900px; margin: 0 auto; }
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        .logo-image { height: 36px; width: 36px; object-fit: contain; }
        .logo-text { font-size: 1.5em; font-weight: 700; color: var(--text-light); }
        .logo-text .highlight { color: var(--db-accent-purple); }
        .header-tagline {
            color: rgba(255,255,255,0.6);
            font-size: 0.85em;
            margin-bottom: 10px;
        }
        .version-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            color: rgba(255,255,255,0.7);
        }
        .version-badge .dot { width: 5px; height: 5px; background: var(--success); border-radius: 50%; }
        .doc-title { margin-top: 12px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
        .doc-title h2 { color: var(--text-light); font-size: 1.1em; font-weight: 600; margin: 0; padding: 0; border: none; }

        /* Navigation - Compact */
        .doc-nav {
            background: var(--db-nav-dark);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .doc-nav-inner { max-width: 1100px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; }
        .doc-nav a {
            color: rgba(255,255,255,0.55);
            text-decoration: none;
            font-size: 0.78em;
            font-weight: 500;
            padding: 10px 14px;
            border-bottom: 2px solid transparent;
            transition: all 0.15s;
        }
        .doc-nav a:hover { color: var(--text-light); background: rgba(255,255,255,0.05); border-bottom-color: var(--db-accent-purple); }

        /* Content - Tight */
        .content { max-width: 900px; margin: 0 auto; padding: 20px 24px 30px; }

        /* Typography - Compact */
        h1 {
            color: var(--text-dark);
            font-size: 1.6em;
            font-weight: 700;
            margin-bottom: 4px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--db-accent-purple);
        }
        h2 {
            color: var(--text-dark);
            font-size: 1.25em;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 6px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--border-light);
        }
        h3 {
            color: var(--text-dark);
            font-size: 1.05em;
            font-weight: 600;
            margin-top: 14px;
            margin-bottom: 4px;
        }
        h4 {
            color: var(--text-dark);
            font-size: 0.95em;
            font-weight: 600;
            margin-top: 10px;
            margin-bottom: 3px;
        }
        h5, h6 {
            color: var(--text-dark);
            font-size: 0.9em;
            font-weight: 600;
            margin-top: 8px;
            margin-bottom: 2px;
        }
        p { margin-bottom: 8px; color: var(--text-body); }
        strong { color: var(--text-dark); font-weight: 600; }
        a { color: var(--accent-blue); text-decoration: none; }
        a:hover { text-decoration: underline; }

        /* Code - Compact */
        pre {
            background: #1e1e2e;
            border: 1px solid #2d2d3d;
            border-radius: 4px;
            padding: 10px 12px;
            overflow-x: auto;
            margin: 8px 0;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.82em;
            line-height: 1.4;
            color: #e0e0e0;
        }
        code {
            background: #f0f0f2;
            color: #c7254e;
            padding: 1px 4px;
            border-radius: 3px;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.85em;
        }
        pre code { background: none; padding: 0; color: #e0e0e0; }

        /* Tables - Compact */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 0.88em;
            border: 1px solid var(--border-light);
        }
        th {
            background: var(--db-nav-dark);
            color: var(--text-light);
            padding: 8px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        td {
            padding: 7px 10px;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-body);
        }
        tr:last-child td { border-bottom: none; }
        tr:nth-child(even) td { background: #f9f9fb; }

        /* Lists - Tight */
        ul, ol { margin: 6px 0; padding-left: 20px; color: var(--text-body); }
        li { margin-bottom: 2px; }
        li::marker { color: var(--db-accent-purple); }

        /* Blockquotes */
        blockquote {
            background: var(--content-card);
            border-left: 3px solid var(--db-accent-purple);
            border-radius: 0 4px 4px 0;
            padding: 8px 12px;
            margin: 10px 0;
        }
        blockquote p { margin-bottom: 0; }

        /* HR - Minimal */
        hr { border: none; border-top: 1px solid var(--border-light); margin: 16px 0; }

        /* Footer - Compact */
        .footer { background: var(--db-nav-dark); padding: 20px 16px; text-align: center; }
        .footer-content { max-width: 600px; margin: 0 auto; }
        .footer-logo { font-size: 1em; font-weight: 700; color: var(--text-light); margin-bottom: 6px; }
        .footer-logo .highlight { color: var(--db-accent-purple); }
        .footer p { color: rgba(255,255,255,0.5); font-size: 0.8em; margin-bottom: 4px; }
        .footer-links { display: flex; justify-content: center; gap: 16px; margin-top: 10px; flex-wrap: wrap; }
        .footer-links a { color: rgba(255,255,255,0.45); font-size: 0.75em; }
        .footer-links a:hover { color: var(--db-accent-purple); text-decoration: none; }
        .footer-copyright {
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.08);
            font-size: 0.7em;
            color: rgba(255,255,255,0.35);
        }

        /* Print */
        @media print {
            .doc-nav, .footer { display: none; }
            .content { max-width: 100%; padding: 12px; }
            .header-banner { padding: 12px; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-banner { padding: 16px 12px; }
            .logo-text { font-size: 1.2em; }
            .logo-image { height: 28px; width: 28px; }
            .content { padding: 16px 12px; }
            h1 { font-size: 1.4em; }
            h2 { font-size: 1.15em; }
            table { font-size: 0.82em; }
            th, td { padding: 6px 8px; }
            .doc-nav a { padding: 8px 10px; font-size: 0.72em; }
        }
    </style>
</head>
<body>
    <header class="header-banner">
        <div class="header-content">
            <div class="logo-container">
                <img class="logo-image" src="dma-symbol.png" alt="DMA" onerror="this.style.display='none'" />
                <div class="logo-text">Dynatrace Migration Assistant</div>
            </div>
            <p class="header-tagline">Migration Intelligence Platform for Splunk to Dynatrace</p>
            <span class="version-badge"><span class="dot"></span>Version 4.0.1</span>
            <div class="doc-title"><h2>DMA Splunk Enterprise Export - Specification</h2></div>
        </div>
    </header>

    <nav class="doc-nav">
        <div class="doc-nav-inner">
            <a href="README-SPLUNK-ENTERPRISE.html">Enterprise README</a>
            <a href="README-SPLUNK-CLOUD.html">Cloud README</a>
            <a href="SPLUNK-ENTERPRISE-EXPORT-SPECIFICATION.html">Enterprise Spec</a>
            <a href="SPLUNK-CLOUD-EXPORT-SPECIFICATION.html">Cloud Spec</a>
            <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.html">Analytics Reference</a>
            <a href="EXPORT-SCHEMA.html">Export Schema</a>
        </div>
    </nav>

    <main class="content">
<h1>DMA Splunk Enterprise Export Script - Comprehensive Specification</h1>
<h2>Version 4.2.4 | Complete Data Collection Framework</h2>
<p>
<strong>Last Updated</strong>: February 2026
<strong>Related Documents</strong>: <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.md">Script-Generated Analytics Reference</a> | <a href="README-SPLUNK-ENTERPRISE.md">Enterprise README</a> | <a href="EXPORT-SCHEMA.md">Export Schema</a>
</p>
<hr>
<blockquote><p><strong>Developed for Dynatrace One by Enterprise Solutions & Architecture</strong></p></blockquote>
<blockquote><p><em>An ACE Services Division of Dynatrace</em></p></blockquote>
<hr>
<h2>Executive Summary</h2>
<p>
This specification defines the complete requirements for a Splunk data collection script that supports <strong>all Splunk deployment types</strong> and collects <strong>comprehensive migration intelligence</strong> including:
</p>
<ul>
<li><strong>All Splunk Flavors</strong>: Enterprise (standalone, distributed), Cloud, Universal Forwarder, Heavy Forwarder, Search Head Cluster, Indexer Cluster, Deployment Server</li>
<li><strong>Ownership & RBAC</strong>: Users, groups, roles, capabilities, object ownership</li>
<li><strong>Usage Analytics</strong>: Query frequency, dashboard views, alert triggers, index volume trends</li>
<li><strong>Migration Prioritization</strong>: Scoring of high-value assets worth migrating</li>
</ul>
<blockquote><p><strong>Note</strong>: For Splunk Cloud environments, dedicated Cloud export scripts are available: <code>dma-splunk-cloud-export.sh</code> (Bash) and <code>dma-splunk-cloud-export.ps1</code> (PowerShell). See <a href="README-SPLUNK-CLOUD.md">README-SPLUNK-CLOUD.md</a> for details.</p></blockquote>
<hr>
<h2>What's New in v4.2.4</h2>
<h3>Two-Archive Anonymization (Preserves Original Data)</h3>
<p>
When anonymization is enabled, the script now creates <strong>TWO separate archives</strong>:
</p>
<ul>
<li><code>{export_name}.tar.gz</code> - <strong>Original, untouched data</strong> (keep for your records)</li>
<li><code>{export<em>name}</em>masked.tar.gz</code> - <strong>Anonymized copy</strong> (safe to share with third parties)</li>
</ul>
<p>
This preserves the original data in case anonymization corrupts files. Users can re-run anonymization on the original without re-running the entire export.
</p>
<h3>Performance Optimizations</h3>
<ul>
<li><strong>RBAC/Users collection now OFF by default</strong> - Use <code>--rbac</code> flag to enable</li>
<li><strong>Usage analytics now OFF by default</strong> - Use <code>--usage</code> flag to enable</li>
<li><strong>Faster defaults</strong>: Batch size 250 (was 100), API delay 50ms (was 250ms)</li>
<li><strong>Optimized queries</strong>: Sampling for expensive regex extractions, <code>max()</code> instead of <code>latest()</code> for faster aggregations</li>
<li><strong>Savedsearches ACL fix</strong>: Now correctly filters searches by app ownership</li>
</ul>
<hr>
<h2>What's New in v4.2.0</h2>
<h3>App-Centric Dashboard Structure (v2)</h3>
<ul>
<li><strong>No more flat folders</strong>: Dashboards are now saved to <code>{AppName}/dashboards/classic/</code> and <code>{AppName}/dashboards/studio/</code> instead of root-level <code>dashboards<em>classic/</code> and <code>dashboards</em>studio/</code></li>
<li><strong>Prevents name collisions</strong>: Multiple apps can now have dashboards with the same name without data loss</li>
<li><strong>Manifest Schema v4.0</strong>: Added <code>archive<em>structure</em>version: "v2"</code> for DMA to detect and process the new structure</li>
</ul>
<hr>
<h2>What Was New in v4.1.0</h2>
<h3>App-Scoped Export Mode</h3>
<ul>
<li><strong><code>--apps</code> flag</strong>: Export specific apps only (e.g., <code>--apps "search,myapp,security"</code>)</li>
<li><strong><code>--quick</code> mode</strong>: Skip global analytics for fastest possible export (<strong>TESTING ONLY</strong>)</li>
<li><strong><code>--scoped</code> mode</strong>: Scope RBAC/usage collection to selected apps only</li>
<li><strong>Auto-scoped</strong>: When <code>--apps</code> is specified, collections automatically scope to those apps</li>
</ul>
<blockquote><p><strong>âš ï¸ WARNING</strong>: <code>--quick</code> is for <strong>testing/validation only</strong>. It eliminates usage analytics, user data, and RBAC information critical for migration analysis. Always use full or <code>--scoped</code> export for actual migration planning.</p></blockquote>
<h3>Debug Mode</h3>
<ul>
<li><strong><code>--debug</code> flag</strong>: Enable verbose logging for troubleshooting</li>
<li><strong>Debug log file</strong>: <code>export_debug.log</code> with detailed API/search lifecycle</li>
<li><strong>Color-coded console output</strong>: ERROR (red), WARN (yellow), API (cyan), SEARCH (magenta), TIMING (blue)</li>
<li><strong>Sensitive data redaction</strong>: Passwords and tokens automatically redacted in debug output</li>
</ul>
<h3>Skip Collection Options</h3>
<ul>
<li><strong><code>--no-usage</code></strong>: Skip usage analytics collection</li>
<li><strong><code>--no-rbac</code></strong>: Skip RBAC/user collection</li>
</ul>
<h3>Performance Improvements</h3>
<ul>
<li><strong>App-filtered queries</strong>: RBAC and usage searches now filter by selected apps</li>
<li><strong>Reduced scope</strong>: Quick mode can complete in minutes vs hours for large environments</li>
</ul>
<hr>
<h2>What's New in v4.0.1</h2>
<h3>Container Compatibility Improvements</h3>
<ul>
<li><strong>Container-friendly progress display</strong>: Progress bars now use newlines at 5% intervals instead of carriage returns, ensuring clean output in kubectl exec, Docker exec, and other containerized environments</li>
<li><strong>Improved output formatting</strong>: Progress updates print cleanly without overlapping lines in non-TTY environments</li>
</ul>
<hr>
<h2>What's New in v4.0.0</h2>
<h3>Enterprise-Ready Defaults</h3>
<ul>
<li><strong>Zero-configuration reliability</strong>: Defaults tuned for environments with 4000+ dashboards and 10K+ alerts</li>
<li><strong>Extended timeouts</strong>: <code>API<em>TIMEOUT=120s</code>, <code>MAX</em>TOTAL<em>TIME=43200s</code> (12 hours), search <code>max</em>wait=300s</code></li>
<li><strong>Optimized rate limiting</strong>: <code>RATE<em>LIMIT</em>DELAY=0.1s</code> - fast but polite API calls</li>
</ul>
<h3>Enterprise Resilience Features</h3>
<ul>
<li><strong>Paginated API calls</strong>: <code>splunk<em>api</em>call<em>paginated</code> with configurable <code>BATCH</em>SIZE</code> (default: 250)</li>
<li><strong>Checkpoint/resume</strong>: Automatic detection of incomplete exports with resume capability</li>
<li><strong>SHC Captain detection</strong>: Warning when running on Search Head Cluster Captain</li>
<li><strong>Export timing statistics</strong>: Detailed timing report at completion</li>
</ul>
<h3>Enhanced Features (from v4.0.0)</h3>
<ul>
<li><strong>Python-based JSON processing</strong>: Uses Splunk's bundled Python or system Python for all JSON operations</li>
<li><strong>Container compatibility</strong>: Multiple hostname fallbacks for Docker/Kubernetes environments</li>
<li><strong>Progress bars</strong>: Visual feedback during long operations like dashboard exports</li>
<li><strong>Scale warnings</strong>: Alerts when exporting large environments (200+ dashboards, 500+ alerts, etc.)</li>
<li><strong>Dashboard Studio JSON extraction</strong>: Automatically extracts JSON definitions from CDATA blocks</li>
</ul>
<h3>Bug Fixes</h3>
<ul>
<li>Fixed progress bar showing >100% in Usage Intelligence section</li>
<li>Improved error handling for REST API failures</li>
<li>Better handling of special characters in dashboard names</li>
</ul>
<hr>
<h2>Table of Contents</h2>
<ol>
<li><a href="#1-splunk-deployment-types">Splunk Deployment Types</a></li>
<li><a href="#2-detection--environment-profiling">Detection & Environment Profiling</a></li>
<li><a href="#3-data-collection-categories">Data Collection Categories</a></li>
<li><a href="#4-users-groups--rbac-collection">Users, Groups & RBAC Collection</a></li>
<li><a href="#5-usage-analytics-collection">Usage Analytics Collection</a></li>
<li><a href="#6-output-structure--summary-file">Output Structure & Summary File</a></li>
<li><a href="#7-script-flow--interactive-prompts">Script Flow & Interactive Prompts</a></li>
<li><a href="#8-api-endpoints-reference">API Endpoints Reference</a></li>
<li><a href="#9-error-handling--fallbacks">Error Handling & Fallbacks</a></li>
<li><a href="#10-security-considerations">Security Considerations</a></li>
</ol>
<hr>
<h2>1. Splunk Deployment Types</h2>
<h3>1.1 Splunk Flavors Matrix</h3>
<table>
<thead>
<tr><th>Flavor</th><th>Description</th><th>Has Local Data?</th><th>Has REST API?</th><th>Typical Role</th></tr>
</thead>
<tbody>
<tr><td><strong>Enterprise Standalone</strong></td><td>Single-server deployment</td><td>Yes</td><td>Yes</td><td>Full stack</td></tr>
<tr><td><strong>Enterprise Search Head</strong></td><td>Search & UI tier</td><td>Limited</td><td>Yes</td><td>Search, dashboards</td></tr>
<tr><td><strong>Enterprise Indexer</strong></td><td>Data storage tier</td><td>Yes</td><td>Yes</td><td>Indexing, storage</td></tr>
<tr><td><strong>Search Head Cluster (SHC)</strong></td><td>Clustered search tier</td><td>Limited</td><td>Yes</td><td>HA search</td></tr>
<tr><td><strong>Indexer Cluster (IDX)</strong></td><td>Clustered indexer tier</td><td>Yes</td><td>Yes</td><td>HA storage</td></tr>
<tr><td><strong>Heavy Forwarder (HF)</strong></td><td>Parsing forwarder</td><td>Transit only</td><td>Yes</td><td>Data routing</td></tr>
<tr><td><strong>Universal Forwarder (UF)</strong></td><td>Lightweight forwarder</td><td>Transit only</td><td>Limited</td><td>Data collection</td></tr>
<tr><td><strong>Deployment Server (DS)</strong></td><td>Configuration manager</td><td>No</td><td>Yes</td><td>Config distribution</td></tr>
<tr><td><strong>License Master (LM)</strong></td><td>License management</td><td>No</td><td>Yes</td><td>Licensing</td></tr>
<tr><td><strong>Cluster Master/Manager</strong></td><td>Cluster coordination</td><td>No</td><td>Yes</td><td>Cluster management</td></tr>
<tr><td><strong>Splunk Cloud</strong></td><td>SaaS deployment</td><td>Yes (managed)</td><td>Yes</td><td>Full stack</td></tr>
<tr><td><strong>Splunk Cloud Gateway</strong></td><td>Hybrid connector</td><td>No</td><td>Yes</td><td>Cloud bridge</td></tr>
</tbody>
</table>
<h3>1.2 Detection Signatures</h3>
<pre><code class="language-bash"># Detection logic for each flavor

# Universal Forwarder Detection
- Binary: splunkd (smaller footprint)
- Path: /opt/splunkforwarder
- No web UI (port 8000)
- File: $SPLUNK_HOME/etc/splunk-launch.conf contains SPLUNK_ROLE=universalforwarder

# Heavy Forwarder Detection
- Has parsing capability (props.conf processing)
- No local indexes (or minimal)
- File: outputs.conf routes all data externally
- Often has: TCP/UDP inputs defined

# Search Head Detection
- Has web UI (port 8000)
- distributed_search.conf with distsearch enabled
- search peers configured
- Limited or no local indexes

# Search Head Cluster Member Detection
- File: $SPLUNK_HOME/etc/system/local/server.conf contains [shclustering]
- shcluster_label defined
- Has captain/member role

# Indexer Detection
- Large local indexes (data/db directories)
- inputs.conf with TCP receiving (splunktcp://)
- File: indexes.conf with hot/warm/cold paths defined

# Indexer Cluster Peer Detection
- File: server.conf contains [clustering] with mode = slave
- master_uri configured
- replication_factor &gt; 0

# Cluster Master/Manager Detection
- File: server.conf contains [clustering] with mode = master
- Manages multiple cluster peers

# Deployment Server Detection
- File: serverclass.conf exists
- deployment-apps/ directory with apps
- Manages forwarder configurations

# License Master Detection
- File: server.conf contains [license] section
- license_master_uri = self

# Splunk Cloud Detection
- Domain: *.splunkcloud.com
- Cloud-specific REST endpoints
- Managed infrastructure indicators</code></pre>
<h3>1.3 Flavor-Specific Collection Paths</h3>
<table>
<thead>
<tr><th>Flavor</th><th>Configuration</th><th>Dashboards</th><th>Alerts</th><th>Indexes</th><th>Usage Stats</th><th>Users/RBAC</th></tr>
</thead>
<tbody>
<tr><td>Standalone</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td></tr>
<tr><td>Search Head</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âš ï¸ Limited</td><td>âœ… Full</td><td>âœ… Full</td></tr>
<tr><td>SHC Member</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âš ï¸ Limited</td><td>âœ… Full</td><td>âœ… Via Captain</td></tr>
<tr><td>Indexer</td><td>âœ… Limited</td><td>âŒ None</td><td>âŒ None</td><td>âœ… Full</td><td>âš ï¸ Index only</td><td>âš ï¸ Limited</td></tr>
<tr><td>IDX Cluster</td><td>âœ… Limited</td><td>âŒ None</td><td>âŒ None</td><td>âœ… Full</td><td>âš ï¸ Index only</td><td>âš ï¸ Limited</td></tr>
<tr><td>Heavy Forwarder</td><td>âœ… Routing</td><td>âŒ None</td><td>âŒ None</td><td>âŒ None</td><td>âš ï¸ Throughput</td><td>âš ï¸ Limited</td></tr>
<tr><td>Universal Forwarder</td><td>âœ… Inputs</td><td>âŒ None</td><td>âŒ None</td><td>âŒ None</td><td>âš ï¸ Throughput</td><td>âŒ None</td></tr>
<tr><td>Deployment Server</td><td>âœ… Deployed</td><td>âŒ None</td><td>âŒ None</td><td>âŒ None</td><td>âŒ None</td><td>âš ï¸ Limited</td></tr>
<tr><td>Cloud</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td><td>âœ… Full</td></tr>
</tbody>
</table>
<hr>
<h2>2. Detection & Environment Profiling</h2>
<h3>2.1 Environment Detection Workflow</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     START DETECTION                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Locate SPLUNK_HOME                                  â”‚
â”‚   - Check $SPLUNK_HOME env variable                         â”‚
â”‚   - Check /opt/splunk, /opt/splunkforwarder                 â”‚
â”‚   - Check /Applications/Splunk (macOS)                      â”‚
â”‚   - Prompt user if not found                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Determine Splunk Product Type                       â”‚
â”‚   - Check splunk-launch.conf for SPLUNK_ROLE                â”‚
â”‚   - Check binary size/footprint                             â”‚
â”‚   - Check for web.conf (UI capability)                      â”‚
â”‚   - Result: Enterprise, Universal Forwarder, Heavy Forwarderâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Detect Deployment Architecture                      â”‚
â”‚   - Check server.conf [clustering] section                  â”‚
â”‚   - Check server.conf [shclustering] section                â”‚
â”‚   - Check distsearch.conf for search peers                  â”‚
â”‚   - Check for deployment-apps/ directory                    â”‚
â”‚   - Result: Standalone, Cluster, SHC, Deployment Server     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Determine Node Role                                 â”‚
â”‚   - Search Head vs Indexer vs Forwarder                     â”‚
â”‚   - Master/Captain vs Member/Peer                           â”‚
â”‚   - License Master detection                                â”‚
â”‚   - Result: Specific role classification                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: Check Splunk Cloud Indicators                       â”‚
â”‚   - Check server.conf for cloud settings                    â”‚
â”‚   - Check for *.splunkcloud.com in configs                  â”‚
â”‚   - Check for cloud-specific apps                           â”‚
â”‚   - Result: On-prem vs Cloud vs Hybrid                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: Generate Environment Profile                        â”‚
â”‚   {                                                         â”‚
â”‚     &quot;product&quot;: &quot;enterprise|uf|hf&quot;,                          â”‚
â”‚     &quot;architecture&quot;: &quot;standalone|distributed|cloud&quot;,         â”‚
â”‚     &quot;role&quot;: &quot;search_head|indexer|forwarder|...&quot;,           â”‚
â”‚     &quot;clustering&quot;: { &quot;type&quot;: &quot;none|shc|idx&quot;, ... },         â”‚
â”‚     &quot;capabilities&quot;: [&quot;search&quot;, &quot;index&quot;, &quot;forward&quot;, ...]    â”‚
â”‚   }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h3>2.2 Environment Profile Schema</h3>
<pre><code class="language-json">{
  &quot;environmentProfile&quot;: {
    &quot;detectionTimestamp&quot;: &quot;2025-12-03T10:30:00Z&quot;,
    &quot;hostname&quot;: &quot;splunk-sh-01.company.com&quot;,
    &quot;splunkHome&quot;: &quot;/opt/splunk&quot;,

    &quot;product&quot;: {
      &quot;type&quot;: &quot;enterprise&quot;,
      &quot;version&quot;: &quot;9.1.2&quot;,
      &quot;build&quot;: &quot;12345abc&quot;,
      &quot;edition&quot;: &quot;enterprise&quot;,
      &quot;platform&quot;: &quot;linux-x86_64&quot;
    },

    &quot;architecture&quot;: {
      &quot;type&quot;: &quot;distributed&quot;,
      &quot;isCloud&quot;: false,
      &quot;isHybrid&quot;: false
    },

    &quot;role&quot;: {
      &quot;primary&quot;: &quot;search_head&quot;,
      &quot;isClusterMember&quot;: true,
      &quot;clusterType&quot;: &quot;shc&quot;,
      &quot;clusterRole&quot;: &quot;member&quot;,
      &quot;captainUri&quot;: &quot;https://shc-captain:8089&quot;,
      &quot;clusterLabel&quot;: &quot;production_shc&quot;
    },

    &quot;capabilities&quot;: {
      &quot;hasWebUI&quot;: true,
      &quot;hasSearchCapability&quot;: true,
      &quot;hasIndexCapability&quot;: false,
      &quot;hasForwardingCapability&quot;: false,
      &quot;hasDeploymentServer&quot;: false,
      &quot;hasLicenseMaster&quot;: false
    },

    &quot;connectedComponents&quot;: {
      &quot;searchPeers&quot;: [&quot;idx1:8089&quot;, &quot;idx2:8089&quot;, &quot;idx3:8089&quot;],
      &quot;deploymentServer&quot;: &quot;ds.company.com:8089&quot;,
      &quot;licenseMaster&quot;: &quot;lm.company.com:8089&quot;,
      &quot;clusterMaster&quot;: null
    },

    &quot;recommendedCollectionPath&quot;: &quot;search_head_full&quot;
  }
}</code></pre>
<hr>
<h2>3. Data Collection Categories</h2>
<h3>3.1 Configuration Files</h3>
<h4>Core Configuration Files (All Flavors)</h4>
<table>
<thead>
<tr><th>File</th><th>Purpose</th><th>Priority</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td><code>server.conf</code></td><td>Server identity, clustering</td><td>Critical</td><td>Reveals architecture</td></tr>
<tr><td><code>inputs.conf</code></td><td>Data inputs</td><td>Critical</td><td>All input definitions</td></tr>
<tr><td><code>outputs.conf</code></td><td>Data routing</td><td>Critical</td><td>Forwarding topology</td></tr>
<tr><td><code>props.conf</code></td><td>Field extraction, parsing</td><td>Critical</td><td>Data transformation</td></tr>
<tr><td><code>transforms.conf</code></td><td>Transformations, routing</td><td>Critical</td><td>Data processing</td></tr>
<tr><td><code>indexes.conf</code></td><td>Index definitions</td><td>Critical</td><td>Storage configuration</td></tr>
<tr><td><code>authentication.conf</code></td><td>Auth configuration</td><td>High</td><td>LDAP, SAML, etc.</td></tr>
<tr><td><code>authorize.conf</code></td><td>Role definitions</td><td>High</td><td>RBAC policies</td></tr>
</tbody>
</table>
<h4>Search & UI Configuration (Search Heads Only)</h4>
<table>
<thead>
<tr><th>File</th><th>Purpose</th><th>Priority</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td><code>savedsearches.conf</code></td><td>Alerts, scheduled searches</td><td>Critical</td><td>Alert migration</td></tr>
<tr><td><code>macros.conf</code></td><td>Search macros</td><td>High</td><td>Query dependencies</td></tr>
<tr><td><code>eventtypes.conf</code></td><td>Event classification</td><td>Medium</td><td>Semantic layer</td></tr>
<tr><td><code>tags.conf</code></td><td>Tag assignments</td><td>Medium</td><td>Semantic layer</td></tr>
<tr><td><code>workflow_actions.conf</code></td><td>UI workflows</td><td>Low</td><td>UI customization</td></tr>
<tr><td><code>commands.conf</code></td><td>Custom commands</td><td>Medium</td><td>Custom SPL</td></tr>
<tr><td><code>views.xml</code></td><td>Dashboard definitions</td><td>Critical</td><td>Classic dashboards</td></tr>
<tr><td><code>panels.xml</code></td><td>Panel definitions</td><td>Medium</td><td>Reusable panels</td></tr>
<tr><td><code>nav.xml</code></td><td>Navigation menu</td><td>Low</td><td>UI customization</td></tr>
</tbody>
</table>
<h4>Forwarder-Specific Configuration</h4>
<table>
<thead>
<tr><th>File</th><th>Purpose</th><th>Priority</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td><code>deploymentclient.conf</code></td><td>Deployment client config</td><td>High</td><td>DS relationship</td></tr>
<tr><td><code>serverclass.conf</code></td><td>Server classes (DS only)</td><td>High</td><td>App deployment</td></tr>
<tr><td><code>limits.conf</code></td><td>Resource limits</td><td>Medium</td><td>Performance tuning</td></tr>
</tbody>
</table>
<h3>3.2 Collection Locations</h3>
<pre><code>$SPLUNK_HOME/
â”œâ”€â”€ etc/
â”‚   â”œâ”€â”€ system/
â”‚   â”‚   â”œâ”€â”€ default/    # Factory defaults (reference only)
â”‚   â”‚   â””â”€â”€ local/      # System-level customizations âœ… COLLECT
â”‚   â”‚
â”‚   â”œâ”€â”€ apps/
â”‚   â”‚   â””â”€â”€ [app_name]/
â”‚   â”‚       â”œâ”€â”€ default/    # App defaults âœ… COLLECT
â”‚   â”‚       â”œâ”€â”€ local/      # App customizations âœ… COLLECT
â”‚   â”‚       â”œâ”€â”€ lookups/    # Lookup tables âœ… COLLECT
â”‚   â”‚       â”œâ”€â”€ bin/        # Custom scripts âš ï¸ OPTIONAL
â”‚   â”‚       â””â”€â”€ static/     # Static assets âš ï¸ OPTIONAL
â”‚   â”‚
â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â””â”€â”€ [username]/
â”‚   â”‚       â””â”€â”€ [app]/
â”‚   â”‚           â””â”€â”€ local/  # User-level objects âœ… COLLECT
â”‚   â”‚
â”‚   â”œâ”€â”€ deployment-apps/    # (Deployment Server only)
â”‚   â”‚   â””â”€â”€ [app_name]/     âœ… COLLECT
â”‚   â”‚
â”‚   â””â”€â”€ shcluster/          # (SHC members only)
â”‚       â””â”€â”€ apps/
â”‚           â””â”€â”€ [app_name]/ âœ… COLLECT
â”‚
â””â”€â”€ var/
    â”œâ”€â”€ lib/splunk/
    â”‚   â””â”€â”€ kvstore/        # KV Store data âš ï¸ OPTIONAL
    â”‚
    â””â”€â”€ log/splunk/
        â””â”€â”€ audit.log       # Audit trail âœ… COLLECT (usage stats)</code></pre>
<hr>
<h2>4. Users, Groups & RBAC Collection</h2>
<h3>4.1 Authentication & Authorization Data</h3>
<h4>4.1.1 User Collection</h4>
<pre><code class="language-bash"># REST API Endpoint
GET /services/authentication/users
GET /services/authentication/users/{username}

# Collect for each user:
{
  &quot;username&quot;: &quot;splunk_user&quot;,
  &quot;realname&quot;: &quot;Sample User&quot;,
  &quot;email&quot;: &quot;splunk_user@company.com&quot;,
  &quot;roles&quot;: [&quot;admin&quot;, &quot;power_user&quot;],
  &quot;defaultApp&quot;: &quot;search&quot;,
  &quot;type&quot;: &quot;Splunk&quot;,           # Splunk, LDAP, SAML, etc.
  &quot;lastLoginTime&quot;: &quot;2025-12-03T08:30:00Z&quot;,
  &quot;createdAt&quot;: &quot;2023-06-01T00:00:00Z&quot;,
  &quot;capabilities&quot;: [&quot;admin_all_objects&quot;, &quot;edit_tcp&quot;, ...],
  &quot;searchFilter&quot;: null
}</code></pre>
<h4>4.1.2 Role Collection</h4>
<pre><code class="language-bash"># REST API Endpoint
GET /services/authorization/roles
GET /services/authorization/roles/{rolename}

# Collect for each role:
{
  &quot;roleName&quot;: &quot;power_user&quot;,
  &quot;importedRoles&quot;: [&quot;user&quot;],
  &quot;capabilities&quot;: [
    &quot;accelerate_datamodel&quot;,
    &quot;edit_modinput_*&quot;,
    &quot;schedule_search&quot;,
    ...
  ],
  &quot;srchIndexesAllowed&quot;: [&quot;main&quot;, &quot;security&quot;, &quot;_*&quot;],
  &quot;srchIndexesDefault&quot;: [&quot;main&quot;],
  &quot;srchFilter&quot;: null,
  &quot;srchTimeWin&quot;: -1,
  &quot;rtSrchJobsQuota&quot;: 6,
  &quot;srchJobsQuota&quot;: 10,
  &quot;srchDiskQuota&quot;: 100
}</code></pre>
<h4>4.1.3 Group Collection (LDAP/SAML)</h4>
<pre><code class="language-bash"># REST API Endpoint (if LDAP configured)
GET /services/authentication/providers/LDAP

# LDAP Group Mapping
{
  &quot;groupName&quot;: &quot;splunk_admins&quot;,
  &quot;mappedRoles&quot;: [&quot;admin&quot;],
  &quot;memberCount&quot;: 5,
  &quot;ldapBaseDN&quot;: &quot;CN=splunk_admins,OU=Groups,DC=company,DC=com&quot;
}

# SAML Group Mapping
GET /services/authentication/providers/SAML
{
  &quot;groupName&quot;: &quot;SSO_Splunk_PowerUsers&quot;,
  &quot;mappedRoles&quot;: [&quot;power_user&quot;],
  &quot;attributeName&quot;: &quot;groups&quot;
}</code></pre>
<h3>4.2 Object Ownership Mapping</h3>
<h4>4.2.1 Dashboard Ownership</h4>
<pre><code class="language-bash"># REST API for each dashboard
GET /servicesNS/{owner}/{app}/data/ui/views/{dashboard_name}

# Extract ownership:
{
  &quot;dashboardName&quot;: &quot;security_overview&quot;,
  &quot;app&quot;: &quot;security_app&quot;,
  &quot;owner&quot;: &quot;splunk_user&quot;,
  &quot;sharing&quot;: &quot;app&quot;,              # user, app, global
  &quot;permissions&quot;: {
    &quot;read&quot;: [&quot;*&quot;],
    &quot;write&quot;: [&quot;admin&quot;, &quot;power_user&quot;]
  },
  &quot;lastModifiedBy&quot;: &quot;splunk_user&quot;,
  &quot;lastModifiedTime&quot;: &quot;2024-01-10T14:30:00Z&quot;
}</code></pre>
<h4>4.2.2 Alert Ownership</h4>
<pre><code class="language-bash"># REST API for saved searches
GET /servicesNS/{owner}/{app}/saved/searches/{search_name}

# Extract ownership:
{
  &quot;alertName&quot;: &quot;critical_security_alert&quot;,
  &quot;app&quot;: &quot;security_app&quot;,
  &quot;owner&quot;: &quot;security_team&quot;,
  &quot;sharing&quot;: &quot;app&quot;,
  &quot;permissions&quot;: {
    &quot;read&quot;: [&quot;*&quot;],
    &quot;write&quot;: [&quot;security_admins&quot;]
  },
  &quot;isScheduled&quot;: true,
  &quot;actions&quot;: [&quot;email&quot;, &quot;webhook&quot;],
  &quot;lastRunTime&quot;: &quot;2024-01-15T10:00:00Z&quot;,
  &quot;lastModifiedBy&quot;: &quot;mwilson&quot;,
  &quot;lastModifiedTime&quot;: &quot;2024-01-05T09:00:00Z&quot;
}</code></pre>
<h4>4.2.3 Saved Search Ownership</h4>
<pre><code class="language-bash"># Same as alerts - saved searches include:
# - Ad-hoc saved searches (isScheduled: false)
# - Reports (isScheduled: true, actions: [])
# - Alerts (isScheduled: true, actions: [...])</code></pre>
<h3>4.3 RBAC Summary Output</h3>
<pre><code class="language-json">{
  &quot;rbacSummary&quot;: {
    &quot;collectionTimestamp&quot;: &quot;2025-12-03T10:30:00Z&quot;,

    &quot;users&quot;: {
      &quot;total&quot;: 150,
      &quot;byType&quot;: {
        &quot;Splunk&quot;: 25,
        &quot;LDAP&quot;: 120,
        &quot;SAML&quot;: 5
      },
      &quot;activeInLast30Days&quot;: 87,
      &quot;activeInLast90Days&quot;: 142
    },

    &quot;roles&quot;: {
      &quot;total&quot;: 15,
      &quot;custom&quot;: 8,
      &quot;builtin&quot;: 7,
      &quot;list&quot;: [&quot;admin&quot;, &quot;power_user&quot;, &quot;user&quot;, &quot;security_analyst&quot;, ...]
    },

    &quot;groups&quot;: {
      &quot;total&quot;: 12,
      &quot;ldapGroups&quot;: 10,
      &quot;samlGroups&quot;: 2,
      &quot;mappings&quot;: [
        {&quot;group&quot;: &quot;splunk_admins&quot;, &quot;roles&quot;: [&quot;admin&quot;]},
        {&quot;group&quot;: &quot;security_team&quot;, &quot;roles&quot;: [&quot;security_analyst&quot;, &quot;power_user&quot;]}
      ]
    },

    &quot;ownership&quot;: {
      &quot;dashboards&quot;: {
        &quot;total&quot;: 245,
        &quot;byOwner&quot;: [
          {&quot;owner&quot;: &quot;splunk_user&quot;, &quot;count&quot;: 45},
          {&quot;owner&quot;: &quot;security_team&quot;, &quot;count&quot;: 32},
          ...
        ],
        &quot;byApp&quot;: [
          {&quot;app&quot;: &quot;search&quot;, &quot;count&quot;: 89},
          {&quot;app&quot;: &quot;security_app&quot;, &quot;count&quot;: 56},
          ...
        ]
      },
      &quot;alerts&quot;: {
        &quot;total&quot;: 187,
        &quot;byOwner&quot;: [...],
        &quot;byApp&quot;: [...]
      },
      &quot;savedSearches&quot;: {
        &quot;total&quot;: 523,
        &quot;byOwner&quot;: [...],
        &quot;byApp&quot;: [...]
      }
    }
  }
}</code></pre>
<hr>
<h2>5. Usage Analytics Collection</h2>
<h3>5.1 Search & Query Analytics</h3>
<h4>5.1.1 Audit Log Analysis</h4>
<pre><code class="language-bash"># Primary source: $SPLUNK_HOME/var/log/splunk/audit.log
# Contains: All search activity, user logins, configuration changes

# Parse audit.log for search activity:
# - action=search
# - action=savedsearch_dispatch
# - action=alert_fired

# Extract metrics:
{
  &quot;searchActivity&quot;: {
    &quot;period&quot;: &quot;last_30_days&quot;,
    &quot;totalSearches&quot;: 45678,
    &quot;uniqueUsers&quot;: 87,
    &quot;searchesByType&quot;: {
      &quot;adhoc&quot;: 32456,
      &quot;scheduled&quot;: 12000,
      &quot;alertTriggered&quot;: 1222
    }
  }
}</code></pre>
<h4>5.1.2 Search Frequency Analysis</h4>
<pre><code class="language-bash"># REST API for scheduled search history
GET /services/search/jobs

# Internal index query (requires search capability)
index=_audit action=search
| stats count by user, savedsearch_name, search
| sort -count

# Output:
{
  &quot;topSearches&quot;: [
    {
      &quot;searchName&quot;: &quot;Security - Failed Logins&quot;,
      &quot;type&quot;: &quot;scheduled&quot;,
      &quot;executionCount30Days&quot;: 2880,
      &quot;avgRuntimeSeconds&quot;: 12.5,
      &quot;owner&quot;: &quot;security_team&quot;,
      &quot;app&quot;: &quot;security_app&quot;
    },
    ...
  ],
  &quot;topAdhocSearchPatterns&quot;: [
    {
      &quot;pattern&quot;: &quot;index=main sourcetype=access_*&quot;,
      &quot;count&quot;: 1234,
      &quot;uniqueUsers&quot;: 15
    },
    ...
  ]
}</code></pre>
<h3>5.2 Dashboard Usage Analytics</h3>
<h4>5.2.1 Dashboard View Metrics</h4>
<pre><code class="language-bash"># Internal index query
index=_internal sourcetype=splunk_web_access uri=&quot;*/app/*/[dashboard]*&quot;
| stats count as views, dc(user) as unique_users by uri
| sort -views

# REST API approach (if internal indexes not accessible)
GET /services/search/jobs
# Run: | rest /servicesNS/-/-/data/ui/views | stats count by title

# Output:
{
  &quot;dashboardUsage&quot;: {
    &quot;period&quot;: &quot;last_30_days&quot;,
    &quot;totalViews&quot;: 12345,
    &quot;uniqueViewers&quot;: 78,
    &quot;dashboards&quot;: [
      {
        &quot;name&quot;: &quot;security_overview&quot;,
        &quot;app&quot;: &quot;security_app&quot;,
        &quot;views&quot;: 2345,
        &quot;uniqueViewers&quot;: 45,
        &quot;avgSessionDuration&quot;: 180,
        &quot;owner&quot;: &quot;splunk_user&quot;,
        &quot;lastViewed&quot;: &quot;2024-01-15T09:30:00Z&quot;
      },
      ...
    ]
  }
}</code></pre>
<h4>5.2.2 Dashboard Interactivity</h4>
<pre><code class="language-bash"># Track dashboard drilldowns, filter changes
index=_internal sourcetype=splunk_web_access uri=&quot;*/app/*&quot; method=POST
| stats count by uri_path

# Output:
{
  &quot;dashboardInteractions&quot;: {
    &quot;drilldowns&quot;: 5678,
    &quot;filterChanges&quot;: 8901,
    &quot;timeRangeChanges&quot;: 2345,
    &quot;panelRefreshes&quot;: 12345
  }
}</code></pre>
<h3>5.3 Alert Usage Analytics</h3>
<h4>5.3.1 Alert Trigger Metrics</h4>
<pre><code class="language-bash"># From audit.log or _audit index
index=_audit action=alert_fired
| stats count as triggers,
        values(severity) as severities,
        avg(result_count) as avg_results
  by savedsearch_name, app

# Output:
{
  &quot;alertMetrics&quot;: {
    &quot;period&quot;: &quot;last_30_days&quot;,
    &quot;totalTriggers&quot;: 4567,
    &quot;uniqueAlerts&quot;: 87,
    &quot;alerts&quot;: [
      {
        &quot;name&quot;: &quot;Critical - System Down&quot;,
        &quot;app&quot;: &quot;infrastructure&quot;,
        &quot;triggers&quot;: 234,
        &quot;suppressedCount&quot;: 45,
        &quot;avgResultCount&quot;: 3.2,
        &quot;severity&quot;: 5,
        &quot;actions&quot;: [&quot;email&quot;, &quot;pagerduty&quot;],
        &quot;owner&quot;: &quot;ops_team&quot;
      },
      ...
    ]
  }
}</code></pre>
<h4>5.3.2 Alert Action Analytics</h4>
<pre><code class="language-bash"># Track which alert actions are used
index=_internal sourcetype=scheduler action=*
| stats count by alert_actions

# Output:
{
  &quot;alertActions&quot;: {
    &quot;email&quot;: 12345,
    &quot;webhook&quot;: 5678,
    &quot;slack&quot;: 2345,
    &quot;pagerduty&quot;: 1234,
    &quot;script&quot;: 567,
    &quot;summary_index&quot;: 8901
  }
}</code></pre>
<h3>5.4 Index Usage Analytics</h3>
<h4>5.4.1 Index Volume Metrics</h4>
<pre><code class="language-bash"># REST API for index statistics
GET /services/data/indexes-extended

# Or via search
| dbinspect index=*
| stats sum(sizeOnDiskMB) as size_mb, sum(eventCount) as events by index

# Output:
{
  &quot;indexMetrics&quot;: {
    &quot;collectionTimestamp&quot;: &quot;2025-12-03T10:30:00Z&quot;,
    &quot;indexes&quot;: [
      {
        &quot;name&quot;: &quot;main&quot;,
        &quot;sizeOnDiskGB&quot;: 1234.5,
        &quot;totalEventCount&quot;: 12345678901,
        &quot;earliestEvent&quot;: &quot;2023-01-01T00:00:00Z&quot;,
        &quot;latestEvent&quot;: &quot;2024-01-15T10:30:00Z&quot;,
        &quot;retentionDays&quot;: 365,
        &quot;replicationFactor&quot;: 3,
        &quot;searchFactor&quot;: 2,
        &quot;buckets&quot;: {
          &quot;hot&quot;: 5,
          &quot;warm&quot;: 120,
          &quot;cold&quot;: 890
        },
        &quot;ingestionRate&quot;: {
          &quot;last24h_GB&quot;: 45.6,
          &quot;last7d_avgDaily_GB&quot;: 42.3,
          &quot;last30d_avgDaily_GB&quot;: 40.1
        }
      },
      ...
    ],
    &quot;totals&quot;: {
      &quot;totalIndexes&quot;: 45,
      &quot;totalSizeGB&quot;: 12345.6,
      &quot;totalEvents&quot;: 987654321012,
      &quot;dailyIngestionGB&quot;: 456.7
    }
  }
}</code></pre>
<h4>5.4.2 Index Access Patterns</h4>
<pre><code class="language-bash"># From audit log - which indexes are searched most
index=_audit action=search
| rex field=search &quot;index=(?&lt;searched_index&gt;\w+)&quot;
| stats count by searched_index
| sort -count

# Output:
{
  &quot;indexAccessPatterns&quot;: {
    &quot;period&quot;: &quot;last_30_days&quot;,
    &quot;bySearchCount&quot;: [
      {&quot;index&quot;: &quot;main&quot;, &quot;searchCount&quot;: 45678},
      {&quot;index&quot;: &quot;security&quot;, &quot;searchCount&quot;: 34567},
      {&quot;index&quot;: &quot;_internal&quot;, &quot;searchCount&quot;: 12345},
      ...
    ]
  }
}</code></pre>
<h3>5.5 Sourcetype Analytics</h3>
<pre><code class="language-bash"># Sourcetype volume and usage
| tstats count where index=* by index, sourcetype
| stats sum(count) as events by sourcetype

# Output:
{
  &quot;sourcetypeMetrics&quot;: {
    &quot;sourcetypes&quot;: [
      {
        &quot;name&quot;: &quot;access_combined&quot;,
        &quot;eventCount&quot;: 12345678,
        &quot;indexes&quot;: [&quot;main&quot;, &quot;web&quot;],
        &quot;searchFrequency&quot;: 1234,
        &quot;usedInDashboards&quot;: 12,
        &quot;usedInAlerts&quot;: 5
      },
      ...
    ]
  }
}</code></pre>
<h3>5.6 User Activity Analytics</h3>
<pre><code class="language-bash"># User login and activity patterns
index=_audit action=login OR action=search
| stats count as actions,
        min(_time) as first_activity,
        max(_time) as last_activity,
        dc(action) as action_types
  by user
| sort -actions

# Output:
{
  &quot;userActivity&quot;: {
    &quot;period&quot;: &quot;last_30_days&quot;,
    &quot;users&quot;: [
      {
        &quot;username&quot;: &quot;splunk_user&quot;,
        &quot;totalActions&quot;: 12345,
        &quot;searchCount&quot;: 5678,
        &quot;loginCount&quot;: 45,
        &quot;lastActivity&quot;: &quot;2024-01-15T10:25:00Z&quot;,
        &quot;primaryApp&quot;: &quot;security_app&quot;,
        &quot;roles&quot;: [&quot;admin&quot;, &quot;power_user&quot;]
      },
      ...
    ],
    &quot;summary&quot;: {
      &quot;totalLogins&quot;: 4567,
      &quot;uniqueActiveUsers&quot;: 87,
      &quot;avgSearchesPerUser&quot;: 156,
      &quot;peakHour&quot;: 14
    }
  }
}</code></pre>
<hr>
<h2>6. Output Structure & Summary File</h2>
<h3>6.1 Export Directory Structure</h3>
<pre><code>splunk_export_[env_name]_[timestamp]/
â”‚
â”œâ”€â”€ manifest.json                       # ğŸ“‹ STANDARDIZED METADATA (v3.5.0)
â”œâ”€â”€ dma-env-summary.md           # ğŸ“Š MASTER SUMMARY FILE
â”œâ”€â”€ _metadata.json                      # Export metadata
â”œâ”€â”€ _environment_profile.json           # Detected environment profile
â”‚
â”œâ”€â”€ _systeminfo/                        # System infrastructure
â”‚   â”œâ”€â”€ server_info.json
â”‚   â”œâ”€â”€ installed_apps.json
â”‚   â”œâ”€â”€ search_peers.json
â”‚   â”œâ”€â”€ license_info.json
â”‚   â”œâ”€â”€ cluster_info.json
â”‚   â””â”€â”€ deployment_info.json
â”‚
â”œâ”€â”€ _rbac/                              # Users, Groups, Roles
â”‚   â”œâ”€â”€ users.json                      # All users
â”‚   â”œâ”€â”€ roles.json                      # All roles with capabilities
â”‚   â”œâ”€â”€ groups.json                     # LDAP/SAML groups
â”‚   â”œâ”€â”€ authentication.conf             # Auth configuration
â”‚   â”œâ”€â”€ authorize.conf                  # Authorization config
â”‚   â””â”€â”€ ownership_map.json              # Object â†’ Owner mapping
â”‚
â”œâ”€â”€ _usage_analytics/                   # Usage statistics
â”‚   â”œâ”€â”€ search_activity.json            # Search frequency, patterns
â”‚   â”œâ”€â”€ dashboard_usage.json            # Dashboard views, interactions
â”‚   â”œâ”€â”€ alert_metrics.json              # Alert triggers, actions
â”‚   â”œâ”€â”€ index_usage.json                # Index access patterns
â”‚   â”œâ”€â”€ sourcetype_usage.json           # Sourcetype popularity
â”‚   â”œâ”€â”€ user_activity.json              # User engagement
â”‚   â”œâ”€â”€ dashboard_ownership.json        # Dashboard â†’ owner mapping (v3.5.0)
â”‚   â”œâ”€â”€ alert_ownership.json            # Alert â†’ owner mapping (v3.5.0)
â”‚   â”œâ”€â”€ ownership_summary.json          # Ownership by user (v3.5.0)
â”‚   â”œâ”€â”€ top_indexes_by_volume.json      # Volume analysis (v3.5.0)
â”‚   â”œâ”€â”€ top_sourcetypes_by_volume.json  # Sourcetype volume (v3.5.0)
â”‚   â”œâ”€â”€ top_hosts_by_volume.json        # Host volume data (v3.5.0)
â”‚   â”œâ”€â”€ zero_view_dashboards.json       # Elimination candidates (v3.5.0)
â”‚   â”œâ”€â”€ never_fired_alerts.json         # Elimination candidates (v3.5.0)
â”‚   â””â”€â”€ migration_priority_scores.json  # Computed priority rankings
â”‚
â”œâ”€â”€ _indexes/                           # Index configurations
â”‚   â”œâ”€â”€ indexes.conf                    # Index definitions
â”‚   â”œâ”€â”€ indexes_detailed.json           # Full index metadata
â”‚   â””â”€â”€ index_volumes.json              # Size and volume data
â”‚
â”œâ”€â”€ _system/                            # System-level configs
â”‚   â””â”€â”€ local/
â”‚       â”œâ”€â”€ inputs.conf
â”‚       â”œâ”€â”€ outputs.conf
â”‚       â”œâ”€â”€ server.conf
â”‚       â””â”€â”€ web.conf
â”‚
â”œâ”€â”€ [app_name]/                         # Per-app exports (v2 app-centric structure)
â”‚   â”œâ”€â”€ dashboards/                     # v2: App-scoped dashboards (v4.2.0+)
â”‚   â”‚   â”œâ”€â”€ classic/                    # Classic XML dashboards for this app
â”‚   â”‚   â”‚   â””â”€â”€ *.xml
â”‚   â”‚   â””â”€â”€ studio/                     # Dashboard Studio JSON for this app
â”‚   â”‚       â””â”€â”€ *.json
â”‚   â”œâ”€â”€ default/
â”‚   â”‚   â”œâ”€â”€ props.conf
â”‚   â”‚   â”œâ”€â”€ transforms.conf
â”‚   â”‚   â”œâ”€â”€ savedsearches.conf
â”‚   â”‚   â”œâ”€â”€ macros.conf
â”‚   â”‚   â”œâ”€â”€ eventtypes.conf
â”‚   â”‚   â”œâ”€â”€ tags.conf
â”‚   â”‚   â””â”€â”€ data/
â”‚   â”‚       â””â”€â”€ ui/
â”‚   â”‚           â”œâ”€â”€ views/              # Legacy location (v1 archives only)
â”‚   â”‚           â”œâ”€â”€ panels/             # Prebuilt panels
â”‚   â”‚           â””â”€â”€ nav/                # Navigation
â”‚   â”œâ”€â”€ local/
â”‚   â”‚   â””â”€â”€ [same structure as default]
â”‚   â””â”€â”€ lookups/
â”‚       â””â”€â”€ *.csv
â”‚
â””â”€â”€ _audit_sample/                      # Sample audit data (optional)
    â””â”€â”€ audit_sample.log                # Last 10000 audit entries</code></pre>
<h3>6.2 manifest.json Schema (v4.2.0)</h3>
<p>
The script generates a standardized <code>manifest.json</code> with guaranteed schema for DMA:
</p>
<pre><code class="language-json">{
  &quot;schemaVersion&quot;: &quot;4.0&quot;,
  &quot;exportType&quot;: &quot;splunk_enterprise&quot;,
  &quot;exportTimestamp&quot;: &quot;2025-12-03T10:30:00Z&quot;,
  &quot;scriptVersion&quot;: &quot;4.2.0&quot;,
  &quot;archive_structure&quot;: {
    &quot;version&quot;: &quot;v2&quot;,
    &quot;dashboard_organization&quot;: &quot;app_scoped&quot;
  },

  &quot;environment&quot;: {
    &quot;hostname&quot;: &quot;splunk-sh-01.company.com&quot;,
    &quot;splunkHome&quot;: &quot;/opt/splunk&quot;,
    &quot;splunkVersion&quot;: &quot;9.1.2&quot;,
    &quot;splunkFlavor&quot;: &quot;enterprise&quot;,
    &quot;architecture&quot;: &quot;distributed&quot;,
    &quot;role&quot;: &quot;search_head&quot;
  },

  &quot;collection&quot;: {
    &quot;apps&quot;: 45,
    &quot;dashboards&quot;: 245,
    &quot;alerts&quot;: 187,
    &quot;users&quot;: 150,
    &quot;indexes&quot;: 32,
    &quot;errors&quot;: 0,
    &quot;warnings&quot;: 5
  },

  &quot;usageIntelligence&quot;: {
    &quot;analysisPeriod&quot;: &quot;30d&quot;,
    &quot;totalSearches&quot;: 45678,
    &quot;totalDashboardViews&quot;: 12345,
    &quot;totalAlertTriggers&quot;: 4567,
    &quot;topIndexesByVolume&quot;: [...],
    &quot;topSourcetypesByVolume&quot;: [...],
    &quot;topHostsByVolume&quot;: [...],
    &quot;elimination_candidates&quot;: {
      &quot;zeroDashboards&quot;: 12,
      &quot;neverFiredAlerts&quot;: 23
    }
  },

  &quot;exportDuration&quot;: {
    &quot;startTime&quot;: &quot;2025-12-03T10:25:00Z&quot;,
    &quot;endTime&quot;: &quot;2025-12-03T10:32:45Z&quot;,
    &quot;durationSeconds&quot;: 465
  }
}</code></pre>
<h3>6.3 Master Summary File: dma-env-summary.md</h3>
<pre><code class="language-markdown"># DynaSplunk Environment Summary

**Export Date**: 2025-12-03T10:30:00Z
**Splunk Version**: 9.1.2
**Environment ID**: PROD-SH-CLUSTER-01
**Export Tool Version**: 4.1.0

---

## ğŸ—ï¸ Environment Overview

### Deployment Architecture

| Attribute | Value |
|-----------|-------|
| **Deployment Type** | Distributed (Search Head Cluster + Indexer Cluster) |
| **Product Edition** | Splunk Enterprise |
| **Role** | Search Head (SHC Member) |
| **Cluster Label** | production_shc |
| **Search Peers** | 6 indexers |
| **Total Indexed Data** | 45.6 TB |
| **Daily Ingestion Rate** | 456 GB/day |
| **License Type** | Enterprise Term License |
| **License Daily Quota** | 500 GB |

### Connected Components

| Component | Endpoint | Status |
|-----------|----------|--------|
| SHC Captain | shc-captain.company.com:8089 | Active |
| Indexer Cluster Master | cm.company.com:8089 | Active |
| License Master | lm.company.com:8089 | Active |
| Deployment Server | ds.company.com:8089 | Active |

---

## ğŸ‘¥ Users &amp; Access Summary

### User Statistics

| Metric | Value |
|--------|-------|
| **Total Users** | 150 |
| **Active (30 days)** | 87 (58%) |
| **Active (90 days)** | 142 (95%) |
| **LDAP Users** | 120 (80%) |
| **Local Users** | 25 (17%) |
| **SAML Users** | 5 (3%) |

### Role Distribution

| Role | Users | Capabilities |
|------|-------|--------------|
| admin | 5 | Full admin access |
| power_user | 23 | Schedule searches, create alerts |
| security_analyst | 15 | Security app access |
| user | 107 | Basic search access |

### Top Asset Owners

| Owner | Dashboards | Alerts | Saved Searches |
|-------|------------|--------|----------------|
| security_team | 32 | 45 | 89 |
| splunk_user | 28 | 12 | 34 |
| ops_team | 24 | 38 | 67 |
| network_admin | 18 | 22 | 45 |
| mwilson | 15 | 8 | 23 |

---

## ğŸ“Š Usage Analytics (Last 30 Days)

### Search Activity

| Metric | Value |
|--------|-------|
| **Total Searches** | 45,678 |
| **Unique Users** | 87 |
| **Scheduled Searches** | 12,000 (26%) |
| **Ad-hoc Searches** | 32,456 (71%) |
| **Alert-Triggered** | 1,222 (3%) |
| **Avg Search Runtime** | 8.5 seconds |
| **Peak Hour** | 2:00 PM (14:00) |

### Top 10 Most Executed Searches

| Rank | Search Name | Type | Executions | Avg Runtime | Owner |
|------|-------------|------|------------|-------------|-------|
| 1 | Security - Failed Logins | Scheduled | 2,880 | 12.5s | security_team |
| 2 | Infrastructure Health Check | Scheduled | 2,880 | 8.2s | ops_team |
| 3 | Application Error Monitor | Scheduled | 2,016 | 15.3s | dev_team |
| 4 | Network Traffic Analysis | Scheduled | 1,440 | 45.2s | network_admin |
| 5 | User Activity Report | Scheduled | 720 | 23.1s | compliance |
| ... | ... | ... | ... | ... | ... |

### Dashboard Usage

| Metric | Value |
|--------|-------|
| **Total Dashboard Views** | 12,345 |
| **Unique Viewers** | 78 |
| **Avg Session Duration** | 3.5 minutes |
| **Most Popular Hour** | 10:00 AM |

### Top 10 Most Viewed Dashboards

| Rank | Dashboard | App | Views | Unique Users | Owner |
|------|-----------|-----|-------|--------------|-------|
| 1 | Security Overview | security_app | 2,345 | 45 | security_team |
| 2 | Infrastructure Status | ops_app | 1,890 | 38 | ops_team |
| 3 | Application Performance | apm_app | 1,567 | 32 | dev_team |
| 4 | Network Dashboard | network_app | 1,234 | 28 | network_admin |
| 5 | Compliance Report | compliance | 987 | 15 | compliance |
| ... | ... | ... | ... | ... | ... |

### Alert Statistics

| Metric | Value |
|--------|-------|
| **Total Alert Triggers** | 4,567 |
| **Unique Alerts Fired** | 87 |
| **Suppressed Alerts** | 1,234 |
| **Avg Results per Trigger** | 3.2 |

### Top 10 Most Triggered Alerts

| Rank | Alert Name | Triggers | Severity | Actions | Owner |
|------|------------|----------|----------|---------|-------|
| 1 | Failed Login Threshold | 456 | High | email, pagerduty | security_team |
| 2 | Disk Space Warning | 345 | Medium | email | ops_team |
| 3 | Application Error Spike | 234 | High | slack, pagerduty | dev_team |
| 4 | Network Latency Alert | 189 | Medium | email | network_admin |
| 5 | Unauthorized Access | 156 | Critical | email, pagerduty, script | security_team |
| ... | ... | ... | ... | ... | ... |

---

## ğŸ’¾ Index Statistics

### Index Summary

| Metric | Value |
|--------|-------|
| **Total Indexes** | 45 |
| **Total Size** | 45.6 TB |
| **Total Events** | 987.6 billion |
| **Daily Ingestion** | 456 GB |

### Top 10 Indexes by Size

| Rank | Index | Size (TB) | Events | Retention | Search Freq |
|------|-------|-----------|--------|-----------|-------------|
| 1 | main | 12.3 | 234.5B | 365 days | 45,678 |
| 2 | security | 8.9 | 178.2B | 365 days | 34,567 |
| 3 | network | 7.2 | 145.8B | 180 days | 23,456 |
| 4 | application | 5.6 | 112.3B | 90 days | 12,345 |
| 5 | infrastructure | 4.3 | 89.4B | 90 days | 8,901 |
| ... | ... | ... | ... | ... | ... |

### Top 10 Sourcetypes by Volume

| Rank | Sourcetype | Events | Indexes | Search Freq | Dashboards | Alerts |
|------|------------|--------|---------|-------------|------------|--------|
| 1 | access_combined | 89.5B | main, web | 12,345 | 23 | 12 |
| 2 | syslog | 78.3B | main, security | 23,456 | 18 | 8 |
| 3 | WinEventLog:Security | 56.7B | security | 34,567 | 32 | 24 |
| 4 | cisco:asa | 45.6B | network | 8,901 | 15 | 6 |
| 5 | linux_secure | 34.5B | security | 5,678 | 8 | 4 |
| ... | ... | ... | ... | ... | ... | ... |

---

## ğŸ¯ Migration Priority Scoring

### Priority Calculation Methodology

Assets are scored on a scale of 0-100 based on:
- **Usage Frequency** (40%): How often the asset is used
- **User Reach** (25%): How many users interact with it
- **Business Criticality** (20%): Severity, ownership, app context
- **Data Volume** (15%): Size and ingestion rate

### High Priority Assets (Score &gt; 75)

#### Dashboards to Migrate First

| Priority | Dashboard | Score | Views/30d | Users | Owner | Notes |
|----------|-----------|-------|-----------|-------|-------|-------|
| 1 | Security Overview | 95 | 2,345 | 45 | security_team | Critical security visibility |
| 2 | Infrastructure Status | 92 | 1,890 | 38 | ops_team | Operations essential |
| 3 | Compliance Report | 88 | 987 | 15 | compliance | Regulatory requirement |
| 4 | Application Performance | 85 | 1,567 | 32 | dev_team | High user engagement |
| 5 | Executive Summary | 82 | 567 | 12 | leadership | C-level visibility |

#### Alerts to Migrate First

| Priority | Alert | Score | Triggers/30d | Severity | Owner | Notes |
|----------|-------|-------|--------------|----------|-------|-------|
| 1 | Unauthorized Access | 98 | 156 | Critical | security_team | Security-critical |
| 2 | System Down | 96 | 34 | Critical | ops_team | Availability |
| 3 | Failed Login Threshold | 94 | 456 | High | security_team | Security |
| 4 | Data Exfiltration | 92 | 23 | Critical | security_team | DLP |
| 5 | Application Error Spike | 88 | 234 | High | dev_team | App health |

#### Indexes to Migrate First

| Priority | Index | Score | Size | Search Freq | Sourcetypes | Notes |
|----------|-------|-------|------|-------------|-------------|-------|
| 1 | security | 97 | 8.9 TB | 34,567 | 15 | Security operations |
| 2 | main | 95 | 12.3 TB | 45,678 | 45 | Primary data store |
| 3 | infrastructure | 89 | 4.3 TB | 8,901 | 12 | Ops monitoring |
| 4 | application | 85 | 5.6 TB | 12,345 | 23 | App logs |
| 5 | compliance | 82 | 2.1 TB | 3,456 | 8 | Audit requirements |

### Medium Priority Assets (Score 50-75)

| Asset Type | Count | Top Examples |
|------------|-------|--------------|
| Dashboards | 45 | Network Overview, DB Performance, API Metrics |
| Alerts | 32 | Warning thresholds, capacity alerts |
| Saved Searches | 89 | Reporting queries, analysis searches |
| Indexes | 12 | Development, testing, archive |

### Low Priority Assets (Score &lt; 50)

| Asset Type | Count | Recommendation |
|------------|-------|----------------|
| Dashboards | 78 | Review for archival |
| Alerts | 45 | Consolidate or retire |
| Saved Searches | 234 | Evaluate necessity |
| Indexes | 18 | Consider retention policy |

---

## ğŸ“¦ App Inventory

### Installed Apps Summary

| App | Version | Dashboards | Alerts | Owner | Migration Priority |
|-----|---------|------------|--------|-------|-------------------|
| security_app | 4.2.1 | 32 | 45 | security_team | High |
| ops_app | 2.1.0 | 24 | 38 | ops_team | High |
| network_app | 3.0.2 | 15 | 22 | network_admin | Medium |
| compliance | 1.5.0 | 8 | 12 | compliance | High |
| dev_tools | 2.0.0 | 12 | 8 | dev_team | Medium |
| ... | ... | ... | ... | ... | ... |

---

## ğŸ”„ Data Flow Summary

### Input Types

| Input Type | Count | Volume/Day |
|------------|-------|------------|
| File monitoring | 234 | 45 GB |
| TCP/UDP receivers | 56 | 123 GB |
| HTTP Event Collector | 89 | 78 GB |
| Scripted inputs | 34 | 12 GB |
| Modular inputs | 45 | 89 GB |
| Database inputs | 12 | 34 GB |
| Cloud inputs | 23 | 56 GB |

### Output Destinations

| Destination | Type | Volume/Day |
|-------------|------|------------|
| Local indexers | Indexer cluster | 456 GB |
| AWS S3 (archive) | Smartstore | 234 GB |
| Summary index | Internal | 12 GB |

---

## âš ï¸ Migration Considerations

### Potential Challenges

1. **Custom Commands**: 12 custom SPL commands detected - require manual conversion
2. **Lookup Tables**: 45 CSV lookups (234 MB total) - need data migration strategy
3. **Complex Alerts**: 23 alerts with multi-step actions - review automation needs
4. **Heavy Macros**: 15 macros with nested dependencies - test thoroughly
5. **Custom Visualizations**: 8 custom viz used in dashboards - need alternatives

### Data Gaps

| Category | Issue | Impact | Recommendation |
|----------|-------|--------|----------------|
| Orphaned Dashboards | 12 dashboards with no owner | Medium | Assign ownership |
| Unused Alerts | 23 alerts never triggered | Low | Consider removal |
| Empty Indexes | 5 indexes with no data | Low | Remove or repurpose |
| Duplicate Searches | 34 similar saved searches | Medium | Consolidate |

### Recommended Migration Order

1. **Phase 1 (Critical)**: Security dashboards, critical alerts, main indexes
2. **Phase 2 (High)**: Operations dashboards, infrastructure monitoring
3. **Phase 3 (Medium)**: Application monitoring, development tools
4. **Phase 4 (Low)**: Archive data, deprecated assets

---

## ğŸ“‹ Export Manifest

### Files Included

| Category | Count | Size |
|----------|-------|------|
| Configuration files | 234 | 12 MB |
| Dashboard definitions | 245 | 45 MB |
| Alert configurations | 187 | 8 MB |
| Lookup tables | 45 | 234 MB |
| Audit samples | 1 | 50 MB |
| System info | 12 | 5 MB |
| RBAC data | 6 | 2 MB |
| Usage analytics | 8 | 15 MB |

**Total Export Size**: 371 MB

---

*Generated by DMA Splunk Export Tool v4.0.0*</code></pre>
<hr>
<h2>7. Script Flow & Interactive Prompts</h2>
<h3>7.0 Verbosity & User Guidance Philosophy</h3>
<p>
<strong>CRITICAL REQUIREMENT</strong>: Every prompt in this script MUST include:
</p>
<ol>
<li><strong>Context Explanation</strong>: Why we're asking this question</li>
<li><strong>Impact Statement</strong>: What happens with each choice</li>
<li><strong>Recommendation</strong>: What we suggest for most users</li>
<li><strong>Data Justification</strong>: What data will be collected and why it matters for migration</li>
</ol>
<p>
The script should feel like a guided conversation with an expert, not a terse command-line interrogation.
</p>
<h3>7.1 Complete Script Flow</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SCRIPT START                                 â”‚
â”‚                                                                      â”‚
â”‚  Display banner and version information                              â”‚
â”‚  Check prerequisites (bash version, curl, permissions)               â”‚
â”‚  Display pre-flight checklist and requirements                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: ENVIRONMENT DETECTION                                       â”‚
â”‚                                                                      â”‚
â”‚ 1.1 Detect SPLUNK_HOME                                              â”‚
â”‚     - Auto-detect: /opt/splunk, /opt/splunkforwarder, etc.          â”‚
â”‚     - Prompt if not found                                           â”‚
â”‚                                                                      â”‚
â”‚ 1.2 Detect Splunk Flavor                                            â”‚
â”‚     â†’ Universal Forwarder detected! Limited export available.       â”‚
â”‚     â†’ Enterprise detected! Full export available.                   â”‚
â”‚                                                                      â”‚
â”‚ 1.3 Detect Architecture (standalone/distributed/cloud)              â”‚
â”‚                                                                      â”‚
â”‚ 1.4 Display Environment Profile                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚     â”‚ Detected Environment:                               â”‚          â”‚
â”‚     â”‚   Product: Splunk Enterprise 9.1.2                 â”‚          â”‚
â”‚     â”‚   Role: Search Head (SHC Member)                   â”‚          â”‚
â”‚     â”‚   Architecture: Distributed                         â”‚          â”‚
â”‚     â”‚   Cluster: production_shc                          â”‚          â”‚
â”‚     â”‚   Search Peers: 6 indexers                         â”‚          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Is this correct? (Y/n)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: APPLICATION SELECTION                                       â”‚
â”‚                                                                      â”‚
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚ â•‘  APPLICATION SELECTION                                          â•‘  â”‚
â”‚ â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•‘  WHY WE ASK:                                                    â•‘  â”‚
â”‚ â•‘  Splunk organizes content into &quot;Apps&quot; - containers that hold    â•‘  â”‚
â”‚ â•‘  dashboards, alerts, saved searches, and configurations.        â•‘  â”‚
â”‚ â•‘  We need to know which apps contain the content you want to     â•‘  â”‚
â”‚ â•‘  migrate to Dynatrace.                                          â•‘  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•‘  WHAT WE COLLECT FROM EACH APP:                                 â•‘  â”‚
â”‚ â•‘  â€¢ Dashboards (Classic XML and Dashboard Studio JSON)           â•‘  â”‚
â”‚ â•‘  â€¢ Alerts and Scheduled Searches (savedsearches.conf)           â•‘  â”‚
â”‚ â•‘  â€¢ Field Extractions (props.conf, transforms.conf)              â•‘  â”‚
â”‚ â•‘  â€¢ Lookup Tables (.csv files)                                   â•‘  â”‚
â”‚ â•‘  â€¢ Search Macros (macros.conf)                                  â•‘  â”‚
â”‚ â•‘  â€¢ Event Classifications (eventtypes.conf, tags.conf)           â•‘  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•‘  RECOMMENDATION:                                                â•‘  â”‚
â”‚ â•‘  For a complete migration assessment, we recommend exporting    â•‘  â”‚
â”‚ â•‘  ALL apps. This gives DMA the full picture of your              â•‘  â”‚
â”‚ â•‘  Splunk environment and enables accurate migration planning.    â•‘  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                      â”‚
â”‚ Discovered Applications (45 total):                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  #  â”‚ App Name          â”‚ Dashboards â”‚ Alerts â”‚ Size    â”‚      â”‚  â”‚
â”‚ â”‚ â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚  â”‚
â”‚ â”‚  1  â”‚ search            â”‚ 12         â”‚ 0      â”‚ 2.3 MB  â”‚      â”‚  â”‚
â”‚ â”‚  2  â”‚ security_app      â”‚ 32         â”‚ 45     â”‚ 15.6 MB â”‚      â”‚  â”‚
â”‚ â”‚  3  â”‚ ops_monitoring    â”‚ 24         â”‚ 38     â”‚ 8.9 MB  â”‚      â”‚  â”‚
â”‚ â”‚  4  â”‚ network_app       â”‚ 15         â”‚ 22     â”‚ 5.2 MB  â”‚      â”‚  â”‚
â”‚ â”‚  5  â”‚ compliance        â”‚ 8          â”‚ 12     â”‚ 3.1 MB  â”‚      â”‚  â”‚
â”‚ â”‚ ... â”‚ (40 more apps)    â”‚            â”‚        â”‚         â”‚      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] How would you like to select applications?                  â”‚
â”‚                                                                      â”‚
â”‚   1. Export ALL applications (Recommended for full migration)        â”‚
â”‚      â†’ Includes all 45 apps with their complete configurations       â”‚
â”‚      â†’ Best for comprehensive migration assessment                   â”‚
â”‚      â†’ Estimated export size: ~150 MB                                â”‚
â”‚                                                                      â”‚
â”‚   2. Enter specific app names (comma-separated)                      â”‚
â”‚      â†’ Example: security_app, ops_monitoring, compliance             â”‚
â”‚      â†’ Use this if you know exactly which apps to migrate            â”‚
â”‚      â†’ Faster export, smaller file size                              â”‚
â”‚                                                                      â”‚
â”‚   3. Select from numbered list                                       â”‚
â”‚      â†’ Enter numbers like: 1,2,5,7-10                                â”‚
â”‚      â†’ Interactive selection for browsing apps                       â”‚
â”‚                                                                      â”‚
â”‚   4. Export system configurations only (no apps)                     â”‚
â”‚      â†’ Only collects indexes, inputs, system-level configs           â”‚
â”‚      â†’ Use for infrastructure-only assessment                        â”‚
â”‚                                                                      â”‚
â”‚ Enter choice [1]:                                                    â”‚
â”‚                                                                      â”‚
â”‚ â”€â”€ If option 2 selected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                      â”‚
â”‚ Enter app names (comma-separated):                                   â”‚
â”‚ &gt; security_app, ops_monitoring, compliance                           â”‚
â”‚                                                                      â”‚
â”‚ Validating app names...                                              â”‚
â”‚ âœ“ security_app - Found (32 dashboards, 45 alerts)                   â”‚
â”‚ âœ“ ops_monitoring - Found (24 dashboards, 38 alerts)                 â”‚
â”‚ âœ“ compliance - Found (8 dashboards, 12 alerts)                      â”‚
â”‚                                                                      â”‚
â”‚ Total: 3 apps selected (64 dashboards, 95 alerts)                   â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Proceed with these 3 apps? (Y/n)                           â”‚
â”‚                                                                      â”‚
â”‚ â”€â”€ If option 3 selected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                      â”‚
â”‚ Enter app numbers (e.g., 1,2,5 or 1-5,8,10):                        â”‚
â”‚ &gt; 2,3,5                                                              â”‚
â”‚                                                                      â”‚
â”‚ Selected apps:                                                       â”‚
â”‚ âœ“ security_app (32 dashboards, 45 alerts)                           â”‚
â”‚ âœ“ ops_monitoring (24 dashboards, 38 alerts)                         â”‚
â”‚ âœ“ compliance (8 dashboards, 12 alerts)                              â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Proceed with these 3 apps? (Y/n)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: DATA CATEGORY SELECTION                                     â”‚
â”‚                                                                      â”‚
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚ â•‘  DATA CATEGORIES TO COLLECT                                     â•‘  â”‚
â”‚ â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•‘  WHY WE ASK:                                                    â•‘  â”‚
â”‚ â•‘  Different migration scenarios require different data. For     â•‘  â”‚
â”‚ â•‘  example, if you only want to migrate dashboards, you might    â•‘  â”‚
â”‚ â•‘  skip collecting user activity data. However, for a complete   â•‘  â”‚
â”‚ â•‘  migration assessment, we recommend collecting everything.     â•‘  â”‚
â”‚ â•‘                                                                 â•‘  â”‚
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                      â”‚
â”‚ Select data categories to collect:                                   â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 1. Configuration Files (props, transforms, indexes, inputs)     â”‚
â”‚        â†’ Required for understanding data pipeline                    â”‚
â”‚        â†’ Maps how Splunk processes and stores data                   â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 2. Dashboards (Classic XML + Dashboard Studio JSON)             â”‚
â”‚        â†’ Visual content for conversion to Dynatrace apps            â”‚
â”‚        â†’ Includes all panels, queries, and layouts                   â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 3. Alerts &amp; Saved Searches (savedsearches.conf)                 â”‚
â”‚        â†’ Critical for operational continuity                         â”‚
â”‚        â†’ Includes schedules, triggers, and actions                   â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 4. Users, Roles &amp; Groups (RBAC data)                            â”‚
â”‚        â†’ Essential for ownership mapping                             â”‚
â”‚        â†’ Identifies who owns which dashboards/alerts                 â”‚
â”‚        â†’ Helps prioritize migration by team                          â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 5. Usage Analytics (search frequency, dashboard views)          â”‚
â”‚        â†’ Identifies high-value assets worth migrating                â”‚
â”‚        â†’ Shows which content is actively used                        â”‚
â”‚        â†’ Enables data-driven migration prioritization                â”‚
â”‚                                                                      â”‚
â”‚ [âœ“] 6. Index &amp; Data Statistics                                       â”‚
â”‚        â†’ Volume metrics for capacity planning                        â”‚
â”‚        â†’ Retention settings for Dynatrace bucket config              â”‚
â”‚        â†’ Sourcetype mapping for OpenPipeline                         â”‚
â”‚                                                                      â”‚
â”‚ [ ] 7. Lookup Tables (.csv files)                                    â”‚
â”‚        â†’ Reference data used in searches                             â”‚
â”‚        â†’ May contain sensitive data - review before including        â”‚
â”‚                                                                      â”‚
â”‚ [ ] 8. Audit Log Sample (last 10,000 entries)                        â”‚
â”‚        â†’ Detailed search patterns for analysis                       â”‚
â”‚        â†’ May contain sensitive query content                         â”‚
â”‚                                                                      â”‚
â”‚ Enter categories to toggle (e.g., 7,8 to add) or press Enter:       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: AUTHENTICATION                                              â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Enter Splunk admin credentials for REST API access:        â”‚
â”‚   Username [admin]:                                                  â”‚
â”‚   Password: ********                                                 â”‚
â”‚                                                                      â”‚
â”‚ Testing authentication...                                            â”‚
â”‚ âœ“ Authentication successful                                         â”‚
â”‚                                                                      â”‚
â”‚ Checking capabilities...                                             â”‚
â”‚ âœ“ admin_all_objects: YES                                            â”‚
â”‚ âœ“ list_users: YES                                                   â”‚
â”‚ âœ“ list_roles: YES                                                   â”‚
â”‚ âš  audit_read: NO (usage analytics will be limited)                  â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Continue with limited capabilities? (Y/n)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: USAGE ANALYTICS OPTIONS                                     â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Usage analytics collection period:                         â”‚
â”‚   1. Last 7 days                                                    â”‚
â”‚   2. Last 30 days (Recommended)                                     â”‚
â”‚   3. Last 90 days                                                   â”‚
â”‚   4. Last 365 days                                                  â”‚
â”‚   5. Skip usage analytics                                           â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Collect audit log sample? (y/N)                            â”‚
â”‚   This helps identify search patterns but may contain sensitive dataâ”‚
â”‚   Max sample size: 10,000 entries                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: DATA COLLECTION                                             â”‚
â”‚                                                                      â”‚
â”‚ Progress display with stages:                                        â”‚
â”‚                                                                      â”‚
â”‚ [1/10] Collecting system information...                    âœ“        â”‚
â”‚ [2/10] Collecting installed apps...                        âœ“        â”‚
â”‚ [3/10] Collecting configuration files...                   â³ 45%   â”‚
â”‚        â””â”€ security_app/default/props.conf                           â”‚
â”‚        â””â”€ security_app/local/savedsearches.conf                     â”‚
â”‚ [4/10] Collecting dashboards (Classic XML)...              â—‹        â”‚
â”‚ [5/10] Collecting dashboards (Dashboard Studio)...         â—‹        â”‚
â”‚ [6/10] Collecting users and roles...                       â—‹        â”‚
â”‚ [7/10] Collecting LDAP/SAML groups...                      â—‹        â”‚
â”‚ [8/10] Collecting usage analytics...                       â—‹        â”‚
â”‚ [9/10] Collecting index statistics...                      â—‹        â”‚
â”‚ [10/10] Generating summary report...                        â—‹        â”‚
â”‚                                                                      â”‚
â”‚ Current: props.conf (45 stanzas)                                    â”‚
â”‚ Elapsed: 00:02:34 | Estimated remaining: 00:05:12                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: SUMMARY GENERATION                                          â”‚
â”‚                                                                      â”‚
â”‚ Calculating migration priority scores...                             â”‚
â”‚ Generating dma-env-summary.md...                             â”‚
â”‚                                                                      â”‚
â”‚ Summary Preview:                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ â”‚ Environment: PROD-SH-CLUSTER-01                        â”‚          â”‚
â”‚ â”‚ Total Dashboards: 245 (High priority: 23)              â”‚          â”‚
â”‚ â”‚ Total Alerts: 187 (High priority: 15)                  â”‚          â”‚
â”‚ â”‚ Total Users: 150 (Active: 87)                          â”‚          â”‚
â”‚ â”‚ Total Data: 45.6 TB across 45 indexes                  â”‚          â”‚
â”‚ â”‚                                                        â”‚          â”‚
â”‚ â”‚ Migration Complexity Score: 72/100 (Medium-High)       â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: ARCHIVE CREATION                                            â”‚
â”‚                                                                      â”‚
â”‚ Creating compressed archive...                                       â”‚
â”‚ âœ“ Archive created: /tmp/splunk_export_PROD_20240115_103000.tar.gz  â”‚
â”‚ âœ“ Size: 371 MB                                                      â”‚
â”‚ âœ“ Files: 567                                                        â”‚
â”‚                                                                      â”‚
â”‚ SHA256: a1b2c3d4e5f6...                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: COMPLETION                                                   â”‚
â”‚                                                                      â”‚
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚ â•‘                    EXPORT COMPLETE!                             â•‘  â”‚
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                      â”‚
â”‚ Export file: /tmp/splunk_export_PROD_20240115_103000.tar.gz         â”‚
â”‚ Size: 371 MB                                                        â”‚
â”‚ Duration: 00:07:45                                                  â”‚
â”‚                                                                      â”‚
â”‚ NEXT STEPS:                                                         â”‚
â”‚ 1. Download the export file                                         â”‚
â”‚ 2. Open DMA in Dynatrace                                            â”‚
â”‚ 3. Upload the .tar.gz file                                          â”‚
â”‚                                                                      â”‚
â”‚ The dma-env-summary.md file contains:                        â”‚
â”‚ â€¢ Environment overview                                              â”‚
â”‚ â€¢ User and access summary                                           â”‚
â”‚ â€¢ Usage analytics for last 30 days                                  â”‚
â”‚ â€¢ Migration priority rankings                                       â”‚
â”‚ â€¢ Recommended migration phases                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h3>7.2 Flavor-Specific Prompts</h3>
<h4>Universal Forwarder Detected</h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸  UNIVERSAL FORWARDER DETECTED                                    â”‚
â”‚                                                                      â”‚
â”‚ This is a Universal Forwarder installation.                          â”‚
â”‚ Universal Forwarders have limited data available for export:        â”‚
â”‚                                                                      â”‚
â”‚ Available:                                                           â”‚
â”‚   âœ“ inputs.conf (data sources)                                      â”‚
â”‚   âœ“ outputs.conf (forwarding config)                                â”‚
â”‚   âœ“ props.conf (if any local parsing)                               â”‚
â”‚   âœ“ deploymentclient.conf (if managed by DS)                        â”‚
â”‚                                                                      â”‚
â”‚ NOT Available:                                                       â”‚
â”‚   âœ— Dashboards (no search capability)                               â”‚
â”‚   âœ— Alerts (no search capability)                                   â”‚
â”‚   âœ— Users/RBAC (minimal)                                            â”‚
â”‚   âœ— Usage analytics (no searches)                                   â”‚
â”‚                                                                      â”‚
â”‚ For full export, run this script on:                                â”‚
â”‚   â€¢ Search Head                                                     â”‚
â”‚   â€¢ Deployment Server (for deployed configs)                        â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Continue with forwarder export? (Y/n)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h4>Search Head Cluster Detected</h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”· SEARCH HEAD CLUSTER MEMBER DETECTED                              â”‚
â”‚                                                                      â”‚
â”‚ This node is part of a Search Head Cluster.                         â”‚
â”‚                                                                      â”‚
â”‚ Cluster Details:                                                    â”‚
â”‚   Cluster Label: production_shc                                     â”‚
â”‚   This Node: shc-member-02.company.com                              â”‚
â”‚   Captain: shc-captain.company.com                                  â”‚
â”‚   Members: 3                                                        â”‚
â”‚                                                                      â”‚
â”‚ For SHC environments, we recommend:                                  â”‚
â”‚   â€¢ Run export from the CAPTAIN for most complete data              â”‚
â”‚   â€¢ Use REST API (not file-based) for shared knowledge objects     â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Collection options:                                        â”‚
â”‚   1. Export from this member (may have incomplete shared objects)   â”‚
â”‚   2. Connect to Captain and export from there (Recommended)         â”‚
â”‚   3. Exit and run script on Captain node                            â”‚
â”‚                                                                      â”‚
â”‚ Select option [2]:                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h4>Splunk Cloud Detected</h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ï¸  SPLUNK CLOUD ENVIRONMENT DETECTED                               â”‚
â”‚                                                                      â”‚
â”‚ This appears to be a Splunk Cloud deployment.                       â”‚
â”‚                                                                      â”‚
â”‚ Cloud Stack: production.splunkcloud.com                             â”‚
â”‚ Region: us-west-2                                                   â”‚
â”‚                                                                      â”‚
â”‚ For Splunk Cloud exports:                                           â”‚
â”‚   â€¢ File system access is limited                                   â”‚
â”‚   â€¢ All collection will use REST API                                â”‚
â”‚   â€¢ Some internal indexes may not be accessible                     â”‚
â”‚                                                                      â”‚
â”‚ Required: Splunk Cloud admin credentials                            â”‚
â”‚                                                                      â”‚
â”‚ [PROMPT] Enter Splunk Cloud admin username:                         â”‚
â”‚ [PROMPT] Enter Splunk Cloud admin password:                         â”‚
â”‚                                                                      â”‚
â”‚ Testing connection to production.splunkcloud.com:8089...            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<hr>
<h2>8. API Endpoints Reference</h2>
<h3>8.1 Core REST API Endpoints</h3>
<table>
<thead>
<tr><th>Category</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><strong>Server Info</strong></td><td><code>/services/server/info</code></td><td>GET</td><td>Version, OS, platform</td></tr>
<tr><td><strong>Server Settings</strong></td><td><code>/services/server/settings</code></td><td>GET</td><td>Server configuration</td></tr>
<tr><td><strong>Apps</strong></td><td><code>/services/apps/local</code></td><td>GET</td><td>Installed apps list</td></tr>
<tr><td><strong>Indexes</strong></td><td><code>/services/data/indexes</code></td><td>GET</td><td>Index list and metadata</td></tr>
<tr><td><strong>Indexes Extended</strong></td><td><code>/services/data/indexes-extended</code></td><td>GET</td><td>Detailed index stats</td></tr>
<tr><td><strong>Inputs</strong></td><td><code>/services/data/inputs/all</code></td><td>GET</td><td>All data inputs</td></tr>
</tbody>
</table>
<h3>8.2 User & RBAC Endpoints</h3>
<table>
<thead>
<tr><th>Category</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><strong>Users</strong></td><td><code>/services/authentication/users</code></td><td>GET</td><td>All users</td></tr>
<tr><td><strong>Roles</strong></td><td><code>/services/authorization/roles</code></td><td>GET</td><td>All roles</td></tr>
<tr><td><strong>Capabilities</strong></td><td><code>/services/authorization/capabilities</code></td><td>GET</td><td>All capabilities</td></tr>
<tr><td><strong>Current User</strong></td><td><code>/services/authentication/current-context</code></td><td>GET</td><td>Current auth context</td></tr>
<tr><td><strong>LDAP</strong></td><td><code>/services/authentication/providers/LDAP</code></td><td>GET</td><td>LDAP config</td></tr>
<tr><td><strong>SAML</strong></td><td><code>/services/authentication/providers/SAML</code></td><td>GET</td><td>SAML config</td></tr>
</tbody>
</table>
<h3>8.3 Knowledge Objects Endpoints</h3>
<table>
<thead>
<tr><th>Category</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><strong>Saved Searches</strong></td><td><code>/servicesNS/-/-/saved/searches</code></td><td>GET</td><td>All saved searches/alerts</td></tr>
<tr><td><strong>Dashboards</strong></td><td><code>/servicesNS/-/-/data/ui/views</code></td><td>GET</td><td>All dashboards</td></tr>
<tr><td><strong>Panels</strong></td><td><code>/servicesNS/-/-/data/ui/panels</code></td><td>GET</td><td>All panels</td></tr>
<tr><td><strong>Macros</strong></td><td><code>/servicesNS/-/-/admin/macros</code></td><td>GET</td><td>All macros</td></tr>
<tr><td><strong>Eventtypes</strong></td><td><code>/servicesNS/-/-/saved/eventtypes</code></td><td>GET</td><td>All eventtypes</td></tr>
<tr><td><strong>Tags</strong></td><td><code>/servicesNS/-/-/configs/conf-tags</code></td><td>GET</td><td>All tags</td></tr>
<tr><td><strong>Lookups</strong></td><td><code>/servicesNS/-/-/data/lookup-table-files</code></td><td>GET</td><td>All lookup files</td></tr>
<tr><td><strong>Transforms</strong></td><td><code>/servicesNS/-/-/data/transforms/extractions</code></td><td>GET</td><td>Field extractions</td></tr>
</tbody>
</table>
<h3>8.4 Cluster & Distributed Endpoints</h3>
<table>
<thead>
<tr><th>Category</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><strong>Search Peers</strong></td><td><code>/services/search/distributed/peers</code></td><td>GET</td><td>Indexer peers</td></tr>
<tr><td><strong>Cluster Master</strong></td><td><code>/services/cluster/master/info</code></td><td>GET</td><td>CM info</td></tr>
<tr><td><strong>Cluster Peers</strong></td><td><code>/services/cluster/master/peers</code></td><td>GET</td><td>Cluster peer list</td></tr>
<tr><td><strong>SHC Captain</strong></td><td><code>/services/shcluster/captain/info</code></td><td>GET</td><td>SHC captain info</td></tr>
<tr><td><strong>SHC Members</strong></td><td><code>/services/shcluster/captain/members</code></td><td>GET</td><td>SHC member list</td></tr>
</tbody>
</table>
<h3>8.5 Usage Analytics Endpoints</h3>
<table>
<thead>
<tr><th>Category</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><strong>Search Jobs</strong></td><td><code>/services/search/jobs</code></td><td>GET</td><td>Recent search jobs</td></tr>
<tr><td><strong>Introspection</strong></td><td><code>/services/server/introspection</code></td><td>GET</td><td>Internal metrics</td></tr>
<tr><td><strong>Deployment Clients</strong></td><td><code>/services/deployment/server/clients</code></td><td>GET</td><td>Forwarder list</td></tr>
<tr><td><strong>License Usage</strong></td><td><code>/services/licenser/usage</code></td><td>GET</td><td>License consumption</td></tr>
</tbody>
</table>
<h3>8.6 Search-Based Analytics (Internal Indexes)</h3>
<pre><code class="language-bash"># These require search capability and access to internal indexes

# Search activity from audit index
index=_audit action=search earliest=-30d
| stats count by user, savedsearch_name

# Dashboard views from web access logs
index=_internal sourcetype=splunk_web_access uri=&quot;*/app/*&quot; earliest=-30d
| stats count by uri_path

# Alert triggers
index=_audit action=alert_fired earliest=-30d
| stats count by savedsearch_name, app

# Index usage patterns
index=_audit action=search earliest=-30d
| rex field=search &quot;index=(?&lt;searched_index&gt;\w+)&quot;
| stats count by searched_index</code></pre>
<hr>
<h2>9. Error Handling & Fallbacks</h2>
<h3>9.1 Error Categories and Responses</h3>
<table>
<thead>
<tr><th>Error Type</th><th>Detection</th><th>Fallback Strategy</th></tr>
</thead>
<tbody>
<tr><td><strong>No REST API access</strong></td><td>HTTP 401/403</td><td>File-based collection only</td></tr>
<tr><td><strong>Limited capabilities</strong></td><td>Missing capabilities</td><td>Collect what's accessible, note gaps</td></tr>
<tr><td><strong>File permission denied</strong></td><td>EACCES errors</td><td>Skip file, continue, report</td></tr>
<tr><td><strong>Network timeout</strong></td><td>Connection timeout</td><td>Retry 3x, then skip</td></tr>
<tr><td><strong>Large file</strong></td><td>File > 100MB</td><td>Sample or truncate</td></tr>
<tr><td><strong>Missing directory</strong></td><td>ENOENT</td><td>Skip, continue</td></tr>
<tr><td><strong>Corrupted config</strong></td><td>Parse error</td><td>Include raw, flag for review</td></tr>
</tbody>
</table>
<h3>9.2 Fallback Collection Matrix</h3>
<table>
<thead>
<tr><th>Primary Method</th><th>Fallback 1</th><th>Fallback 2</th><th>Last Resort</th></tr>
</thead>
<tbody>
<tr><td>REST API + Files</td><td>REST API only</td><td>Files only</td><td>Abort with partial</td></tr>
<tr><td>Internal index search</td><td>Audit log parse</td><td>Skip analytics</td><td>Note in summary</td></tr>
<tr><td>SHC Captain query</td><td>Local member data</td><td>REST API</td><td>Note limitations</td></tr>
<tr><td>Cluster-wide stats</td><td>Local node only</td><td>Skip</td><td>Note limitations</td></tr>
</tbody>
</table>
<h3>9.3 Error Reporting Format</h3>
<pre><code class="language-json">{
  &quot;errors&quot;: [
    {
      &quot;timestamp&quot;: &quot;2024-01-15T10:32:15Z&quot;,
      &quot;stage&quot;: &quot;collect_users&quot;,
      &quot;severity&quot;: &quot;warning&quot;,
      &quot;message&quot;: &quot;Unable to access LDAP configuration&quot;,
      &quot;endpoint&quot;: &quot;/services/authentication/providers/LDAP&quot;,
      &quot;httpStatus&quot;: 403,
      &quot;fallback&quot;: &quot;LDAP group mappings will not be included&quot;,
      &quot;impactedData&quot;: [&quot;groups.json&quot;, &quot;rbacSummary.ldapGroups&quot;]
    }
  ],
  &quot;warnings&quot;: [...],
  &quot;skipped&quot;: [...]
}</code></pre>
<hr>
<h2>10. Security Considerations</h2>
<h3>10.1 Sensitive Data Handling</h3>
<table>
<thead>
<tr><th>Data Type</th><th>Sensitivity</th><th>Handling</th></tr>
</thead>
<tbody>
<tr><td><strong>User passwords</strong></td><td>Critical</td><td>NEVER collect</td></tr>
<tr><td><strong>API tokens</strong></td><td>Critical</td><td>NEVER collect</td></tr>
<tr><td><strong>LDAP bind passwords</strong></td><td>Critical</td><td>NEVER collect</td></tr>
<tr><td><strong>Session tokens</strong></td><td>High</td><td>NEVER collect</td></tr>
<tr><td><strong>User emails</strong></td><td>Medium</td><td>Collect, mark PII</td></tr>
<tr><td><strong>Real names</strong></td><td>Medium</td><td>Collect, mark PII</td></tr>
<tr><td><strong>IP addresses</strong></td><td>Low</td><td>Collect</td></tr>
<tr><td><strong>Hostnames</strong></td><td>Low</td><td>Collect</td></tr>
</tbody>
</table>
<h3>10.2 Configuration Sanitization</h3>
<pre><code class="language-bash"># Before including config files, sanitize:

# Remove passwords
sed -i &#039;s/password\s*=\s*.*/password = [REDACTED]/g&#039; file.conf

# Remove tokens
sed -i &#039;s/token\s*=\s*.*/token = [REDACTED]/g&#039; file.conf

# Remove private keys
sed -i &#039;s/privateKey\s*=\s*.*/privateKey = [REDACTED]/g&#039; file.conf

# Remove connection strings with credentials
sed -i &#039;s/\(connection.*:\/\/[^:]*:\)[^@]*@/\1[REDACTED]@/g&#039; file.conf</code></pre>
<h3>10.3 Audit Log Sampling</h3>
<pre><code class="language-bash"># When collecting audit samples:

# 1. Limit sample size (max 10,000 entries)
tail -10000 audit.log &gt; audit_sample.log

# 2. Anonymize if requested
# Replace usernames with hashes
# Replace IPs with anonymized versions
# Remove search query content (may contain sensitive data)</code></pre>
<h3>10.4 Export File Protection</h3>
<pre><code class="language-bash"># 1. Set restrictive permissions on export file
chmod 600 export.tar.gz

# 2. Generate checksum for integrity
sha256sum export.tar.gz &gt; export.tar.gz.sha256

# 3. Recommend secure transfer
echo &quot;Transfer this file using SCP, SFTP, or other encrypted method&quot;
echo &quot;Delete the export file after upload to DMA&quot;</code></pre>
<hr>
<h2>Appendix A: Complete Script Pseudocode</h2>
<pre><code class="language-bash">#!/bin/bash
# DMA Splunk Export Script v3.0.0

# =============================================================================
# INITIALIZATION
# =============================================================================

display_banner()
check_prerequisites()  # bash version, curl, permissions
initialize_logging()

# =============================================================================
# STEP 1: ENVIRONMENT DETECTION
# =============================================================================

detect_splunk_home() {
  # Check env var, common paths, prompt if needed
}

detect_splunk_flavor() {
  # Returns: enterprise|uf|hf
  check_splunk_launch_conf()
  check_binary_footprint()
  check_web_capability()
}

detect_architecture() {
  # Returns: standalone|distributed|cloud
  check_server_conf_clustering()
  check_server_conf_shclustering()
  check_distsearch_conf()
  check_cloud_indicators()
}

detect_node_role() {
  # Returns: search_head|indexer|forwarder|captain|master|...
  analyze_configuration_files()
  analyze_running_services()
}

build_environment_profile() {
  # Combine all detection results into JSON profile
}

display_environment_profile()
prompt_confirmation()

# =============================================================================
# STEP 2: SCOPE SELECTION
# =============================================================================

prompt_export_scope() {
  # 1. Full export
  # 2. Specific apps
  # 3. Specific categories
  # 4. Minimal (configs only)
}

if [ &quot;$scope&quot; == &quot;specific_apps&quot; ]; then
  display_app_selector()
  prompt_app_selection()
fi

if [ &quot;$scope&quot; == &quot;specific_categories&quot; ]; then
  display_category_selector()
  prompt_category_selection()
fi

# =============================================================================
# STEP 3: AUTHENTICATION
# =============================================================================

prompt_credentials()
test_authentication()
check_capabilities()

if [ &quot;$missing_capabilities&quot; ]; then
  display_capability_warnings()
  prompt_continue_with_limitations()
fi

# =============================================================================
# STEP 4: USAGE ANALYTICS OPTIONS
# =============================================================================

prompt_analytics_period()  # 7d, 30d, 90d, 365d, skip
prompt_audit_log_sample()  # y/n

# =============================================================================
# STEP 5: DATA COLLECTION
# =============================================================================

create_export_directory()

# Stage 1: System Information
collect_server_info()
collect_installed_apps()
collect_cluster_info()

# Stage 2: Configuration Files
for app in $apps; do
  collect_app_configs &quot;$app&quot;
done
collect_system_configs()

# Stage 3: Dashboards
collect_classic_dashboards()      # XML files
collect_dashboard_studio()        # REST API JSON

# Stage 4: Alerts &amp; Saved Searches
collect_saved_searches()

# Stage 5: Users &amp; RBAC
collect_users()
collect_roles()
collect_groups()
build_ownership_map()

# Stage 6: Usage Analytics
collect_search_activity()
collect_dashboard_usage()
collect_alert_metrics()
collect_index_usage()
collect_user_activity()

# Stage 7: Index Statistics
collect_index_details()
collect_sourcetype_stats()

# =============================================================================
# STEP 6: SUMMARY GENERATION
# =============================================================================

calculate_priority_scores()
generate_summary_markdown()

# =============================================================================
# STEP 7: ARCHIVE CREATION
# =============================================================================

create_tarball()
calculate_checksum()
cleanup_temp_files()

# =============================================================================
# STEP 8: COMPLETION
# =============================================================================

display_summary()
display_next_steps()</code></pre>
<hr>
<h2>Appendix B: Migration Priority Scoring Algorithm</h2>
<pre><code class="language-python">def calculate_priority_score(asset):
    &quot;&quot;&quot;
    Calculate migration priority score (0-100) for an asset.

    Weights:
    - Usage Frequency: 40%
    - User Reach: 25%
    - Business Criticality: 20%
    - Data Volume: 15%
    &quot;&quot;&quot;

    # Usage Frequency (0-40 points)
    if asset.type == &quot;dashboard&quot;:
        usage_score = min(40, (asset.views_30d / 100) * 40)
    elif asset.type == &quot;alert&quot;:
        usage_score = min(40, (asset.triggers_30d / 50) * 40)
    elif asset.type == &quot;saved_search&quot;:
        usage_score = min(40, (asset.executions_30d / 500) * 40)
    elif asset.type == &quot;index&quot;:
        usage_score = min(40, (asset.search_count_30d / 1000) * 40)

    # User Reach (0-25 points)
    reach_score = min(25, (asset.unique_users / 20) * 25)

    # Business Criticality (0-20 points)
    criticality_score = 0
    if asset.severity == &quot;critical&quot;:
        criticality_score += 10
    elif asset.severity == &quot;high&quot;:
        criticality_score += 7
    elif asset.severity == &quot;medium&quot;:
        criticality_score += 4

    if asset.owner in HIGH_VALUE_OWNERS:  # security, compliance, ops
        criticality_score += 5

    if asset.app in CRITICAL_APPS:
        criticality_score += 5

    criticality_score = min(20, criticality_score)

    # Data Volume (0-15 points) - only for indexes
    if asset.type == &quot;index&quot;:
        volume_score = min(15, (asset.size_gb / 1000) * 15)
    else:
        volume_score = 0

    # Total Score
    total = usage_score + reach_score + criticality_score + volume_score

    return round(total, 1)</code></pre>
<hr>
<h2>Appendix C: Flavor-Specific Collection Matrices</h2>
<h3>Universal Forwarder Collection</h3>
<table>
<thead>
<tr><th>Category</th><th>Collected</th><th>Method</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td>inputs.conf</td><td>âœ…</td><td>File</td><td>All monitored files/directories</td></tr>
<tr><td>outputs.conf</td><td>âœ…</td><td>File</td><td>Forwarding destinations</td></tr>
<tr><td>props.conf</td><td>âœ…</td><td>File</td><td>Local parsing rules (if any)</td></tr>
<tr><td>transforms.conf</td><td>âœ…</td><td>File</td><td>Local transforms (if any)</td></tr>
<tr><td>deploymentclient.conf</td><td>âœ…</td><td>File</td><td>DS relationship</td></tr>
<tr><td>server.conf</td><td>âœ…</td><td>File</td><td>Basic server config</td></tr>
<tr><td>Server info</td><td>âš ï¸</td><td>REST</td><td>Limited (if REST available)</td></tr>
<tr><td>Dashboards</td><td>âŒ</td><td>N/A</td><td>Not applicable</td></tr>
<tr><td>Alerts</td><td>âŒ</td><td>N/A</td><td>Not applicable</td></tr>
<tr><td>Users/RBAC</td><td>âŒ</td><td>N/A</td><td>Not applicable</td></tr>
<tr><td>Usage stats</td><td>âŒ</td><td>N/A</td><td>Not applicable</td></tr>
</tbody>
</table>
<h3>Heavy Forwarder Collection</h3>
<table>
<thead>
<tr><th>Category</th><th>Collected</th><th>Method</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td>All UF items</td><td>âœ…</td><td>File</td><td>Same as UF</td></tr>
<tr><td>props.conf</td><td>âœ…</td><td>File</td><td>Full parsing rules</td></tr>
<tr><td>transforms.conf</td><td>âœ…</td><td>File</td><td>Full transforms</td></tr>
<tr><td>routing rules</td><td>âœ…</td><td>File</td><td>Data routing configuration</td></tr>
<tr><td>Server info</td><td>âœ…</td><td>REST</td><td>Full server info</td></tr>
<tr><td>Throughput stats</td><td>âš ï¸</td><td>REST</td><td>If metrics available</td></tr>
<tr><td>Users/RBAC</td><td>âš ï¸</td><td>REST</td><td>Limited local users</td></tr>
</tbody>
</table>
<h3>Search Head / SHC Collection</h3>
<table>
<thead>
<tr><th>Category</th><th>Collected</th><th>Method</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td>All configs</td><td>âœ…</td><td>File + REST</td><td>Full collection</td></tr>
<tr><td>Dashboards</td><td>âœ…</td><td>REST</td><td>Classic + Studio</td></tr>
<tr><td>Alerts</td><td>âœ…</td><td>REST</td><td>All saved searches</td></tr>
<tr><td>Users/RBAC</td><td>âœ…</td><td>REST</td><td>Full RBAC</td></tr>
<tr><td>Usage stats</td><td>âœ…</td><td>REST + Search</td><td>Full analytics</td></tr>
<tr><td>Index details</td><td>âš ï¸</td><td>REST</td><td>From search peers</td></tr>
</tbody>
</table>
<h3>Indexer / IDX Cluster Collection</h3>
<table>
<thead>
<tr><th>Category</th><th>Collected</th><th>Method</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td>indexes.conf</td><td>âœ…</td><td>File</td><td>Full index config</td></tr>
<tr><td>props.conf</td><td>âœ…</td><td>File</td><td>Index-time parsing</td></tr>
<tr><td>transforms.conf</td><td>âœ…</td><td>File</td><td>Index-time transforms</td></tr>
<tr><td>Index stats</td><td>âœ…</td><td>REST</td><td>Full volume data</td></tr>
<tr><td>Bucket info</td><td>âœ…</td><td>REST</td><td>Storage details</td></tr>
<tr><td>Dashboards</td><td>âŒ</td><td>N/A</td><td>Run on SH</td></tr>
<tr><td>Alerts</td><td>âŒ</td><td>N/A</td><td>Run on SH</td></tr>
<tr><td>Users/RBAC</td><td>âš ï¸</td><td>REST</td><td>Limited</td></tr>
</tbody>
</table>
<hr>
<p>
<em>End of Specification Document</em>
<em>Version 4.0.0 | DMA Splunk Export Framework</em>
</p>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">Dynatrace Migration Assistant</div>
            <p>Migration intelligence for Splunk to Dynatrace Gen3 Grail</p>
            <div class="footer-links">
                <a href="README-SPLUNK-ENTERPRISE.html">Enterprise Guide</a>
                <a href="README-SPLUNK-CLOUD.html">Cloud Guide</a>
                <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.html">Analytics</a>
                <a href="EXPORT-SCHEMA.html">Schema</a>
            </div>
            <p class="footer-copyright">DMA Project &bull; Built for Dynatrace Gen3 Platform</p>
        </div>
    </footer>
</body>
</html>
