<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMA Splunk Cloud Export - Specification | Dynatrace Migration Assistant</title>
    <style>
        :root {
            --db-header-bg: #14172b;
            --db-nav-dark: #1a1d2e;
            --db-accent-purple: #7c5dc7;
            --db-accent-blue: #4da6e8;
            --db-accent-green: #6abf4b;
            --content-bg: #ffffff;
            --content-card: #f8f9fa;
            --text-dark: #1a1a2e;
            --text-body: #3a3a4a;
            --text-muted: #6c757d;
            --text-light: #ffffff;
            --accent-blue: #1456ff;
            --success: #6abf4b;
            --border-light: #e0e0e0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.45;
            color: var(--text-dark);
            background: var(--content-bg);
            font-size: 14px;
        }

        /* Header - Compact */
        .header-banner {
            background: var(--db-header-bg);
            padding: 20px 16px;
            text-align: center;
        }
        .header-content { max-width: 900px; margin: 0 auto; }
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        .logo-image { height: 36px; width: 36px; object-fit: contain; }
        .logo-text { font-size: 1.5em; font-weight: 700; color: var(--text-light); }
        .logo-text .highlight { color: var(--db-accent-purple); }
        .header-tagline {
            color: rgba(255,255,255,0.6);
            font-size: 0.85em;
            margin-bottom: 10px;
        }
        .version-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            color: rgba(255,255,255,0.7);
        }
        .version-badge .dot { width: 5px; height: 5px; background: var(--success); border-radius: 50%; }
        .doc-title { margin-top: 12px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
        .doc-title h2 { color: var(--text-light); font-size: 1.1em; font-weight: 600; margin: 0; padding: 0; border: none; }

        /* Navigation - Compact */
        .doc-nav {
            background: var(--db-nav-dark);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .doc-nav-inner { max-width: 1100px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; }
        .doc-nav a {
            color: rgba(255,255,255,0.55);
            text-decoration: none;
            font-size: 0.78em;
            font-weight: 500;
            padding: 10px 14px;
            border-bottom: 2px solid transparent;
            transition: all 0.15s;
        }
        .doc-nav a:hover { color: var(--text-light); background: rgba(255,255,255,0.05); border-bottom-color: var(--db-accent-purple); }

        /* Content - Tight */
        .content { max-width: 900px; margin: 0 auto; padding: 20px 24px 30px; }

        /* Typography - Compact */
        h1 {
            color: var(--text-dark);
            font-size: 1.6em;
            font-weight: 700;
            margin-bottom: 4px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--db-accent-purple);
        }
        h2 {
            color: var(--text-dark);
            font-size: 1.25em;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 6px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--border-light);
        }
        h3 {
            color: var(--text-dark);
            font-size: 1.05em;
            font-weight: 600;
            margin-top: 14px;
            margin-bottom: 4px;
        }
        h4 {
            color: var(--text-dark);
            font-size: 0.95em;
            font-weight: 600;
            margin-top: 10px;
            margin-bottom: 3px;
        }
        h5, h6 {
            color: var(--text-dark);
            font-size: 0.9em;
            font-weight: 600;
            margin-top: 8px;
            margin-bottom: 2px;
        }
        p { margin-bottom: 8px; color: var(--text-body); }
        strong { color: var(--text-dark); font-weight: 600; }
        a { color: var(--accent-blue); text-decoration: none; }
        a:hover { text-decoration: underline; }

        /* Code - Compact */
        pre {
            background: #1e1e2e;
            border: 1px solid #2d2d3d;
            border-radius: 4px;
            padding: 10px 12px;
            overflow-x: auto;
            margin: 8px 0;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.82em;
            line-height: 1.4;
            color: #e0e0e0;
        }
        code {
            background: #f0f0f2;
            color: #c7254e;
            padding: 1px 4px;
            border-radius: 3px;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.85em;
        }
        pre code { background: none; padding: 0; color: #e0e0e0; }

        /* Tables - Compact */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 0.88em;
            border: 1px solid var(--border-light);
        }
        th {
            background: var(--db-nav-dark);
            color: var(--text-light);
            padding: 8px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        td {
            padding: 7px 10px;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-body);
        }
        tr:last-child td { border-bottom: none; }
        tr:nth-child(even) td { background: #f9f9fb; }

        /* Lists - Tight */
        ul, ol { margin: 6px 0; padding-left: 20px; color: var(--text-body); }
        li { margin-bottom: 2px; }
        li::marker { color: var(--db-accent-purple); }

        /* Blockquotes */
        blockquote {
            background: var(--content-card);
            border-left: 3px solid var(--db-accent-purple);
            border-radius: 0 4px 4px 0;
            padding: 8px 12px;
            margin: 10px 0;
        }
        blockquote p { margin-bottom: 0; }

        /* HR - Minimal */
        hr { border: none; border-top: 1px solid var(--border-light); margin: 16px 0; }

        /* Footer - Compact */
        .footer { background: var(--db-nav-dark); padding: 20px 16px; text-align: center; }
        .footer-content { max-width: 600px; margin: 0 auto; }
        .footer-logo { font-size: 1em; font-weight: 700; color: var(--text-light); margin-bottom: 6px; }
        .footer-logo .highlight { color: var(--db-accent-purple); }
        .footer p { color: rgba(255,255,255,0.5); font-size: 0.8em; margin-bottom: 4px; }
        .footer-links { display: flex; justify-content: center; gap: 16px; margin-top: 10px; flex-wrap: wrap; }
        .footer-links a { color: rgba(255,255,255,0.45); font-size: 0.75em; }
        .footer-links a:hover { color: var(--db-accent-purple); text-decoration: none; }
        .footer-copyright {
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.08);
            font-size: 0.7em;
            color: rgba(255,255,255,0.35);
        }

        /* Print */
        @media print {
            .doc-nav, .footer { display: none; }
            .content { max-width: 100%; padding: 12px; }
            .header-banner { padding: 12px; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-banner { padding: 16px 12px; }
            .logo-text { font-size: 1.2em; }
            .logo-image { height: 28px; width: 28px; }
            .content { padding: 16px 12px; }
            h1 { font-size: 1.4em; }
            h2 { font-size: 1.15em; }
            table { font-size: 0.82em; }
            th, td { padding: 6px 8px; }
            .doc-nav a { padding: 8px 10px; font-size: 0.72em; }
        }
    </style>
</head>
<body>
    <header class="header-banner">
        <div class="header-content">
            <div class="logo-container">
                <img class="logo-image" src="dma-symbol.png" alt="DMA" onerror="this.style.display='none'" />
                <div class="logo-text">Dynatrace Migration Assistant</div>
            </div>
            <p class="header-tagline">Migration Intelligence Platform for Splunk to Dynatrace</p>
            <span class="version-badge"><span class="dot"></span>Version 4.0.1</span>
            <div class="doc-title"><h2>DMA Splunk Cloud Export - Specification</h2></div>
        </div>
    </header>

    <nav class="doc-nav">
        <div class="doc-nav-inner">
            <a href="README-SPLUNK-ENTERPRISE.html">Enterprise README</a>
            <a href="README-SPLUNK-CLOUD.html">Cloud README</a>
            <a href="SPLUNK-ENTERPRISE-EXPORT-SPECIFICATION.html">Enterprise Spec</a>
            <a href="SPLUNK-CLOUD-EXPORT-SPECIFICATION.html">Cloud Spec</a>
            <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.html">Analytics Reference</a>
            <a href="EXPORT-SCHEMA.html">Export Schema</a>
        </div>
    </nav>

    <main class="content">
<h1>DMA Splunk Cloud Export Script - Technical Specification</h1>
<h2>Version 4.3.0 | REST API-Only Data Collection for Splunk Cloud</h2>
<p>
<strong>Last Updated</strong>: February 2026
<strong>Related Documents</strong>: <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.md">Script-Generated Analytics Reference</a> | <a href="README-SPLUNK-CLOUD.md">Cloud README</a> | <a href="EXPORT-SCHEMA.md">Export Schema</a>
</p>
<hr>
<blockquote><p><strong>Developed for Dynatrace One by Enterprise Solutions & Architecture</strong></p></blockquote>
<blockquote><p><em>An ACE Services Division of Dynatrace</em></p></blockquote>
<hr>
<h2>What's New in v4.3.0</h2>
<h3>Resume Collection (<code>--resume-collect</code> / <code>-ResumeCollect</code>)</h3>
<p>
Resume from a previous export archive to fill gaps without re-collecting everything:
</p>
<ul>
<li>Extracts previous <code>.tar.gz</code>, detects already-collected data, and fills gaps</li>
<li>Versioned output with <code>-v1</code>, <code>-v2</code> suffixes to preserve prior exports</li>
<li>Bash 4.2+ compatible with full POSIX compliance</li>
<li><strong>Per-app skip logic</strong>: Skips dashboards, alerts, and knowledge objects for apps that were already fully collected</li>
<li><strong>Global skip logic</strong>: Skips configs, RBAC, usage analytics, and indexes if already present in the previous archive</li>
</ul>
<pre><code class="language-bash"># Resume from a previous export
./dma-splunk-cloud-export.sh --resume-collect dma_cloud_export_acme_20260115.tar.gz

# PowerShell equivalent
.\dma-splunk-cloud-export.ps1 -ResumeCollect dma_cloud_export_acme_20260115.tar.gz</code></pre>
<h3>12-Hour Max Runtime</h3>
<ul>
<li><code>MAX<em>TOTAL</em>TIME=43200</code> (43,200 seconds = 12 hours) enforced across all scripts</li>
<li>Prevents runaway exports on very large Splunk Cloud environments</li>
<li>Graceful shutdown with partial archive creation when time limit is reached</li>
</ul>
<h3>PowerShell Edition</h3>
<ul>
<li><strong><code>dma-splunk-cloud-export.ps1</code></strong> v4.3.0 provides identical functionality for Windows environments</li>
<li>Zero external dependencies (no Python, no curl, no jq required)</li>
<li>Supports PowerShell 5.1+ (Windows PowerShell) and PowerShell 7+ (cross-platform)</li>
<li>See the <a href="#powershell-edition">PowerShell Edition</a> section below for full parameter mapping</li>
</ul>
<h3>Proxy Support (<code>--proxy</code> / <code>-Proxy</code>)</h3>
<p>
Both Cloud scripts support routing all API connections through a corporate proxy server:
</p>
<ul>
<li><strong>Bash</strong>: <code>--proxy http://proxy.company.com:8080</code> sets <code>CURL<em>PROXY</em>ARGS="-x $PROXY_URL"</code> for all curl calls</li>
<li><strong>PowerShell</strong>: <code>-Proxy "http://proxy.company.com:8080"</code> adds <code>-Proxy</code> parameter to all <code>Invoke-WebRequest</code> calls</li>
<li>When a proxy is configured, DNS resolution and TCP port connectivity tests are skipped (the proxy handles routing)</li>
<li>Interactive prompt asks whether a proxy is needed during setup (default: No); skipped in non-interactive mode or when <code>--proxy</code> / <code>-Proxy</code> is provided</li>
<li>Connectivity failure messages include proxy-specific troubleshooting guidance</li>
</ul>
<hr>
<h2>What's New in v4.2.4</h2>
<h3>Two-Archive Anonymization (Preserves Original Data)</h3>
<p>
When anonymization is enabled, the script now creates <strong>TWO separate archives</strong>:
</p>
<ul>
<li><code>{export_name}.tar.gz</code> - <strong>Original, untouched data</strong> (keep for your records)</li>
<li><code>{export<em>name}</em>masked.tar.gz</code> - <strong>Anonymized copy</strong> (safe to share with third parties)</li>
</ul>
<p>
This preserves the original data in case anonymization corrupts files. Users can re-run anonymization on the original without re-running the entire export.
</p>
<h3>Performance Optimizations</h3>
<ul>
<li><strong>RBAC/Users collection now OFF by default</strong> - Use <code>--rbac</code> flag to enable</li>
<li><strong>Usage analytics now OFF by default</strong> - Use <code>--usage</code> flag to enable</li>
<li><strong>Faster defaults</strong>: Batch size 250 (was 100), API delay 50ms (was 250ms)</li>
<li><strong>Optimized queries</strong>: Sampling for expensive regex extractions, <code>max()</code> instead of <code>latest()</code> for faster aggregations</li>
</ul>
<hr>
<h2>What's New in v4.2.0</h2>
<h3>App-Centric Dashboard Structure (v2)</h3>
<ul>
<li><strong>No more flat folders</strong>: Dashboards are now saved to <code>{AppName}/dashboards/classic/</code> and <code>{AppName}/dashboards/studio/</code> instead of root-level <code>dashboards<em>classic/</code> and <code>dashboards</em>studio/</code></li>
<li><strong>Prevents name collisions</strong>: Multiple apps can now have dashboards with the same name without data loss</li>
<li><strong>Manifest Schema v4.0</strong>: Added <code>archive<em>structure</em>version: "v2"</code> for DMA to detect and process the new structure</li>
</ul>
<hr>
<h2>Executive Summary</h2>
<p>
This specification defines the complete requirements for a <strong>Splunk Cloud-specific</strong> data collection script that operates <strong>100% via REST API</strong> without any file system access.
</p>
<h3>Key Differences from Enterprise Script</h3>
<table>
<thead>
<tr><th>Aspect</th><th>Enterprise Script</th><th>Cloud Script</th></tr>
</thead>
<tbody>
<tr><td><strong>Where it runs</strong></td><td>ON the Splunk server</td><td>ANYWHERE with network access</td></tr>
<tr><td><strong>Access method</strong></td><td>SSH + File system + REST</td><td><strong>REST API ONLY</strong></td></tr>
<tr><td><strong>Authentication</strong></td><td>Local Splunk creds</td><td>Cloud credentials or API tokens</td></tr>
<tr><td><strong>SPLUNK_HOME access</strong></td><td>Yes</td><td>No</td></tr>
<tr><td><strong>File-based configs</strong></td><td>Yes (props.conf, etc.)</td><td>No - must use REST endpoints</td></tr>
<tr><td><strong>Output format</strong></td><td>Same <code>.tar.gz</code> structure</td><td>Same <code>.tar.gz</code> structure</td></tr>
</tbody>
</table>
<hr>
<h2>What's New in v4.1.0</h2>
<h3>App-Scoped Export Mode</h3>
<ul>
<li><strong><code>--apps</code> flag</strong>: Export specific apps only (e.g., <code>--apps "search,myapp,security"</code>)</li>
<li><strong><code>--quick</code> mode</strong>: Skip global analytics for fastest possible export (<strong>TESTING ONLY</strong>)</li>
<li><strong><code>--scoped</code> mode</strong>: Scope RBAC/usage collection to selected apps only</li>
<li><strong>Auto-scoped</strong>: When <code>--apps</code> is specified, collections automatically scope to those apps</li>
</ul>
<blockquote><p><strong>⚠️ WARNING</strong>: <code>--quick</code> is for <strong>testing/validation only</strong>. It eliminates usage analytics, user data, and RBAC information critical for migration analysis. Always use full or <code>--scoped</code> export for actual migration planning.</p></blockquote>
<h3>Debug Mode</h3>
<ul>
<li><strong><code>--debug</code> flag</strong>: Enable verbose logging for troubleshooting</li>
<li><strong>Debug log file</strong>: <code>export_debug.log</code> with detailed API/search lifecycle</li>
<li><strong>Color-coded console output</strong>: ERROR (red), WARN (yellow), API (cyan), SEARCH (magenta), TIMING (blue)</li>
<li><strong>Sensitive data redaction</strong>: Passwords and tokens automatically redacted in debug output</li>
</ul>
<h3>Performance Improvements</h3>
<ul>
<li><strong>App-filtered queries</strong>: Usage searches now filter by selected apps</li>
<li><strong>Reduced scope</strong>: Quick mode can complete in minutes vs hours for large environments</li>
<li><strong><code>--no-usage</code></strong>: Skip usage analytics collection entirely</li>
</ul>
<hr>
<h2>What's New in v4.0.1</h2>
<h3>Container Compatibility Improvements</h3>
<ul>
<li><strong>Container-friendly progress display</strong>: Progress bars now use newlines at 5% intervals instead of carriage returns, ensuring clean output in kubectl exec, Docker exec, and other containerized environments</li>
<li><strong>Improved output formatting</strong>: Progress updates print cleanly without overlapping lines in non-TTY environments</li>
</ul>
<hr>
<h2>What's New in v4.0.0</h2>
<h3>Enterprise Resilience Features (MAJOR UPDATE)</h3>
<p>
The Cloud script now has <strong>full feature parity</strong> with the Enterprise script for large-scale environments:
</p>
<ul>
<li><strong>Paginated API calls</strong>: <code>api<em>call</em>paginated()</code> with configurable <code>BATCH_SIZE</code> (default: 100)</li>
<li><strong>Extended timeouts</strong>: <code>API<em>TIMEOUT=120s</code>, <code>MAX</em>TOTAL_TIME=43200s</code> (12 hours)</li>
<li><strong>Checkpoint/resume</strong>: Automatic detection and resume of incomplete exports</li>
<li><strong>Export timing statistics</strong>: Detailed API call tracking and duration reporting</li>
<li><strong>Zero-configuration reliability</strong>: Defaults tuned for 4000+ dashboards, 10K+ alerts</li>
</ul>
<h3>Enterprise-Ready Defaults</h3>
<table>
<thead>
<tr><th>Setting</th><th>Default</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>BATCH_SIZE</code></td><td>250</td><td>Items per API request</td></tr>
<tr><td><code>RATE_LIMIT_DELAY</code></td><td>0.1s</td><td>Between requests (100ms)</td></tr>
<tr><td><code>API_TIMEOUT</code></td><td>120s</td><td>Per-request timeout</td></tr>
<tr><td><code>MAX_TOTAL_TIME</code></td><td>43200s</td><td>12 hours max runtime</td></tr>
<tr><td><code>MAX_RETRIES</code></td><td>3</td><td>Retry with exponential backoff</td></tr>
<tr><td><code>CHECKPOINT_ENABLED</code></td><td>true</td><td>Enable checkpoint/resume</td></tr>
</tbody>
</table>
<h3>Previous Features (from v3.6.0)</h3>
<ul>
<li><strong>Python-based JSON processing</strong>: All JSON parsing uses Python 3</li>
<li><strong>Container compatibility</strong>: Multiple hostname fallbacks for Docker/Kubernetes</li>
<li><strong>Aligned rate limiting</strong>: Consistent with Enterprise script</li>
</ul>
<hr>
<h2>Table of Contents</h2>
<ol>
<li><a href="#1-splunk-cloud-overview">Splunk Cloud Overview</a></li>
<li><a href="#2-authentication-methods">Authentication Methods</a></li>
<li><a href="#3-rest-api-data-collection">REST API Data Collection</a></li>
<li><a href="#4-api-endpoints-reference">API Endpoints Reference</a></li>
<li><a href="#5-script-flow">Script Flow</a></li>
<li><a href="#6-output-structure">Output Structure</a></li>
<li><a href="#7-usage-intelligence">Usage Intelligence</a></li>
<li><a href="#8-manifest-schema">Manifest Schema</a></li>
<li><a href="#9-rate-limiting--throttling">Rate Limiting & Throttling</a></li>
<li><a href="#10-error-handling">Error Handling</a></li>
<li><a href="#11-security-considerations">Security Considerations</a></li>
</ol>
<hr>
<h2>1. Splunk Cloud Overview</h2>
<h3>1.1 Splunk Cloud Flavors</h3>
<table>
<thead>
<tr><th>Flavor</th><th>Description</th><th>API Access</th><th>Notes</th></tr>
</thead>
<tbody>
<tr><td><strong>Splunk Cloud Classic</strong></td><td>Original multi-tenant cloud</td><td>Full REST API</td><td>Legacy, being phased out</td></tr>
<tr><td><strong>Splunk Cloud Victoria</strong></td><td>Latest cloud architecture</td><td>Full REST API</td><td>Current default</td></tr>
<tr><td><strong>Splunk Cloud on AWS</strong></td><td>AWS-hosted single tenant</td><td>Full REST API</td><td>Enterprise features</td></tr>
<tr><td><strong>Splunk Cloud on GCP</strong></td><td>GCP-hosted single tenant</td><td>Full REST API</td><td>Enterprise features</td></tr>
</tbody>
</table>
<h3>1.2 Cloud Stack URL Patterns</h3>
<pre><code># Standard Splunk Cloud URL patterns
https://&lt;stack-name&gt;.splunkcloud.com           # Web UI
https://&lt;stack-name&gt;.splunkcloud.com:8089      # REST API (management port)

# Examples
https://acme-corp.splunkcloud.com
https://acme-corp.splunkcloud.com:8089/services/server/info

# Some stacks use different patterns
https://inputs.&lt;stack-name&gt;.splunkcloud.com    # HEC endpoint
https://api.&lt;stack-name&gt;.splunkcloud.com       # API endpoint (some configs)</code></pre>
<h3>1.3 What's Accessible via REST API</h3>
<table>
<thead>
<tr><th>Data Type</th><th>REST Endpoint</th><th>Available?</th></tr>
</thead>
<tbody>
<tr><td>Server Info</td><td><code>/services/server/info</code></td><td>✅ Yes</td></tr>
<tr><td>Installed Apps</td><td><code>/services/apps/local</code></td><td>✅ Yes</td></tr>
<tr><td>Dashboards</td><td><code>/servicesNS/-/-/data/ui/views</code></td><td>✅ Yes</td></tr>
<tr><td>Saved Searches/Alerts</td><td><code>/servicesNS/-/-/saved/searches</code></td><td>✅ Yes</td></tr>
<tr><td>Users</td><td><code>/services/authentication/users</code></td><td>✅ Yes</td></tr>
<tr><td>Roles</td><td><code>/services/authorization/roles</code></td><td>✅ Yes</td></tr>
<tr><td>Macros</td><td><code>/servicesNS/-/-/admin/macros</code></td><td>✅ Yes</td></tr>
<tr><td>Eventtypes</td><td><code>/servicesNS/-/-/saved/eventtypes</code></td><td>✅ Yes</td></tr>
<tr><td>Tags</td><td><code>/servicesNS/-/-/configs/conf-tags</code></td><td>✅ Yes</td></tr>
<tr><td>Lookups (definitions)</td><td><code>/servicesNS/-/-/data/lookup-table-files</code></td><td>✅ Yes</td></tr>
<tr><td>Lookup contents</td><td><code>/servicesNS/-/-/data/lookup-table-files/{name}</code></td><td>✅ Yes</td></tr>
<tr><td>Field Extractions</td><td><code>/servicesNS/-/-/data/transforms/extractions</code></td><td>✅ Yes</td></tr>
<tr><td>Props (via conf)</td><td><code>/servicesNS/-/-/configs/conf-props</code></td><td>✅ Yes</td></tr>
<tr><td>Transforms (via conf)</td><td><code>/servicesNS/-/-/configs/conf-transforms</code></td><td>✅ Yes</td></tr>
<tr><td>Indexes</td><td><code>/services/data/indexes</code></td><td>✅ Yes</td></tr>
<tr><td>Index Stats</td><td><code>/services/data/indexes-extended</code></td><td>⚠️ Limited</td></tr>
<tr><td>Search Jobs</td><td><code>/services/search/jobs</code></td><td>✅ Yes</td></tr>
<tr><td>KV Store Collections</td><td><code>/servicesNS/-/-/storage/collections/config</code></td><td>✅ Yes</td></tr>
<tr><td>Audit Logs</td><td><code>index=_audit</code> via search</td><td>⚠️ Requires search</td></tr>
</tbody>
</table>
<h3>1.4 What's NOT Accessible</h3>
<table>
<thead>
<tr><th>Data Type</th><th>Why Not Available</th></tr>
</thead>
<tbody>
<tr><td>Raw config files</td><td>No file system access</td></tr>
<tr><td><code>$SPLUNK_HOME/etc/</code></td><td>No file system access</td></tr>
<tr><td>Audit.log file</td><td>No file system access</td></tr>
<tr><td>Bucket metadata</td><td>No file system access</td></tr>
<tr><td>Internal indexes (some)</td><td>Cloud restrictions</td></tr>
<tr><td>License file</td><td>Cloud-managed</td></tr>
</tbody>
</table>
<hr>
<h2>2. Authentication Methods</h2>
<h3>2.1 Username/Password Authentication</h3>
<pre><code class="language-bash"># Basic authentication
curl -k -u &quot;username:password&quot; \
  &quot;https://acme.splunkcloud.com:8089/services/server/info&quot; \
  -d &quot;output_mode=json&quot;</code></pre>
<p>
<strong>Requirements</strong>:
</p>
<ul>
<li>Splunk Cloud admin account</li>
<li>Account must have required capabilities</li>
<li>May require MFA bypass token for API access</li>
</ul>
<h3>2.2 Splunk Authentication Token</h3>
<pre><code class="language-bash"># Token-based authentication (recommended)
curl -k -H &quot;Authorization: Bearer &lt;token&gt;&quot; \
  &quot;https://acme.splunkcloud.com:8089/services/server/info&quot; \
  -d &quot;output_mode=json&quot;</code></pre>
<p>
<strong>Creating an Auth Token</strong>:
</p>
<ol>
<li>Log into Splunk Cloud web UI</li>
<li>Settings → Tokens</li>
<li>Create new token with required permissions</li>
<li>Set appropriate expiration</li>
</ol>
<p>
<strong>Required Token Permissions</strong>:
</p>
<ul>
<li><code>admin<em>all</em>objects</code></li>
<li><code>list_users</code></li>
<li><code>list_roles</code></li>
<li><code>list_indexes</code></li>
<li><code>search</code></li>
<li><code>rest_access</code></li>
</ul>
<h3>2.3 Session Token Authentication</h3>
<pre><code class="language-bash"># Step 1: Get session key
SESSION_KEY=$(curl -k -u &quot;user:pass&quot; \
  &quot;https://acme.splunkcloud.com:8089/services/auth/login&quot; \
  -d &quot;username=user&amp;password=pass&quot; \
  | grep -oP &#039;(?&lt;=&lt;sessionKey&gt;)[^&lt;]+&#039;)

# Step 2: Use session key
curl -k -H &quot;Authorization: Splunk $SESSION_KEY&quot; \
  &quot;https://acme.splunkcloud.com:8089/services/server/info&quot;</code></pre>
<h3>2.4 Authentication Decision Flow</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                   AUTHENTICATION FLOW                        │
└─────────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────────┐
│ Do you have an API Token?                                   │
│   └─ YES → Use token-based auth (most secure)               │
│   └─ NO  → Do you have username/password?                   │
│             └─ YES → Is MFA required?                       │
│                       └─ YES → Need MFA bypass or token    │
│                       └─ NO  → Use basic auth               │
│             └─ NO  → Cannot authenticate                    │
└─────────────────────────────────────────────────────────────┘</code></pre>
<hr>
<h2>3. REST API Data Collection</h2>
<h3>3.1 Collection Strategy</h3>
<p>
Since we cannot read files, all data must come from REST API endpoints. The strategy is:
</p>
<ol>
<li><strong>Server & Environment Info</strong>: Direct REST calls</li>
<li><strong>Apps & Configurations</strong>: Use <code>/configs/conf-{name}</code> endpoints</li>
<li><strong>Knowledge Objects</strong>: Use <code>/servicesNS/-/-/</code> namespace</li>
<li><strong>Users & RBAC</strong>: Use <code>/services/authentication/</code> and <code>/services/authorization/</code></li>
<li><strong>Usage Analytics</strong>: Run searches against <code>_audit</code> index</li>
<li><strong>Dashboards</strong>: Combine views endpoint with KV Store for Dashboard Studio</li>
</ol>
<h3>3.2 Configuration Reconstruction</h3>
<p>
Since we can't read <code>props.conf</code> directly, we reconstruct it from REST:
</p>
<pre><code class="language-bash"># Get all props stanzas
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/servicesNS/-/-/configs/conf-props&quot; \
  -d &quot;output_mode=json&quot; -d &quot;count=0&quot;

# Get all transforms stanzas
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/servicesNS/-/-/configs/conf-transforms&quot; \
  -d &quot;output_mode=json&quot; -d &quot;count=0&quot;</code></pre>
<h3>3.3 Dashboard Collection</h3>
<pre><code class="language-bash"># Classic Dashboards (SimpleXML)
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/servicesNS/-/-/data/ui/views&quot; \
  -d &quot;output_mode=json&quot; -d &quot;count=0&quot;

# For each dashboard, get the full definition
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/servicesNS/-/-/data/ui/views/{dashboard_name}&quot; \
  -d &quot;output_mode=json&quot;

# Dashboard Studio (stored in KV Store)
# These are included in the views endpoint with isDashboardStudio=true</code></pre>
<h3>3.4 Saved Searches & Alerts</h3>
<pre><code class="language-bash"># Get all saved searches (includes alerts, reports, scheduled searches)
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/servicesNS/-/-/saved/searches&quot; \
  -d &quot;output_mode=json&quot; -d &quot;count=0&quot;

# Each result includes:
# - Search query (SPL)
# - Schedule (cron_schedule)
# - Alert settings (alert.*, action.*)
# - Owner and permissions</code></pre>
<h3>3.5 Usage Analytics via Search</h3>
<pre><code class="language-bash"># Create a search job to get usage analytics
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/services/search/jobs&quot; \
  -d &quot;search=search index=_audit action=search earliest=-30d | stats count by user, savedsearch_name&quot; \
  -d &quot;output_mode=json&quot;

# Poll for completion
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/services/search/jobs/{sid}&quot;

# Get results
curl -k -u &quot;$USER:$PASS&quot; \
  &quot;https://$STACK:8089/services/search/jobs/{sid}/results&quot; \
  -d &quot;output_mode=json&quot; -d &quot;count=0&quot;</code></pre>
<hr>
<h2>4. API Endpoints Reference</h2>
<h3>4.1 System Information</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/services/server/info</code></td><td>GET</td><td>Server version, OS, GUID</td></tr>
<tr><td><code>/services/server/settings</code></td><td>GET</td><td>Server configuration</td></tr>
<tr><td><code>/services/apps/local</code></td><td>GET</td><td>Installed apps list</td></tr>
<tr><td><code>/services/licenser/licenses</code></td><td>GET</td><td>License information</td></tr>
</tbody>
</table>
<h3>4.2 Knowledge Objects</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/servicesNS/-/-/data/ui/views</code></td><td>GET</td><td>All dashboards</td></tr>
<tr><td><code>/servicesNS/-/-/saved/searches</code></td><td>GET</td><td>All saved searches/alerts</td></tr>
<tr><td><code>/servicesNS/-/-/admin/macros</code></td><td>GET</td><td>All search macros</td></tr>
<tr><td><code>/servicesNS/-/-/saved/eventtypes</code></td><td>GET</td><td>All eventtypes</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-tags</code></td><td>GET</td><td>All tags</td></tr>
<tr><td><code>/servicesNS/-/-/data/lookup-table-files</code></td><td>GET</td><td>Lookup file definitions</td></tr>
<tr><td><code>/servicesNS/-/-/data/transforms/extractions</code></td><td>GET</td><td>Field extractions</td></tr>
</tbody>
</table>
<h3>4.3 Configurations (Reconstructed)</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/servicesNS/-/-/configs/conf-props</code></td><td>GET</td><td>Props.conf equivalent</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-transforms</code></td><td>GET</td><td>Transforms.conf equivalent</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-indexes</code></td><td>GET</td><td>Indexes.conf equivalent</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-inputs</code></td><td>GET</td><td>Inputs.conf equivalent</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-outputs</code></td><td>GET</td><td>Outputs.conf equivalent</td></tr>
<tr><td><code>/servicesNS/-/-/configs/conf-savedsearches</code></td><td>GET</td><td>Savedsearches.conf equivalent</td></tr>
</tbody>
</table>
<h3>4.4 Users & RBAC</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/services/authentication/users</code></td><td>GET</td><td>All users</td></tr>
<tr><td><code>/services/authorization/roles</code></td><td>GET</td><td>All roles</td></tr>
<tr><td><code>/services/authentication/current-context</code></td><td>GET</td><td>Current user context</td></tr>
<tr><td><code>/services/admin/SAML-groups</code></td><td>GET</td><td>SAML group mappings</td></tr>
</tbody>
</table>
<h3>4.5 Indexes & Data</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/services/data/indexes</code></td><td>GET</td><td>Index list and settings</td></tr>
<tr><td><code>/services/data/indexes-extended</code></td><td>GET</td><td>Extended index stats</td></tr>
<tr><td><code>/services/catalog/metricstore/dimensions</code></td><td>GET</td><td>Metric dimensions</td></tr>
</tbody>
</table>
<h3>4.6 Search for Analytics</h3>
<table>
<thead>
<tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><code>/services/search/jobs</code></td><td>POST</td><td>Create search job</td></tr>
<tr><td><code>/services/search/jobs/{sid}</code></td><td>GET</td><td>Check job status</td></tr>
<tr><td><code>/services/search/jobs/{sid}/results</code></td><td>GET</td><td>Get search results</td></tr>
</tbody>
</table>
<hr>
<h2>5. Script Flow</h2>
<h3>5.1 Complete Script Flow</h3>
<pre><code>┌─────────────────────────────────────────────────────────────────────┐
│                         SCRIPT START                                 │
│                                                                      │
│  • Display banner                                                   │
│  • Check prerequisites (curl, jq recommended)                       │
│  • Explain this is for Splunk Cloud                                 │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 1: SPLUNK CLOUD CONNECTION                                     │
│                                                                      │
│ ╔════════════════════════════════════════════════════════════════╗  │
│ ║  WHY WE ASK:                                                    ║  │
│ ║  We need to connect to your Splunk Cloud instance via REST API. ║  │
│ ║  This is the only way to access Splunk Cloud data - there is    ║  │
│ ║  no file system or SSH access to Splunk Cloud infrastructure.   ║  │
│ ╚════════════════════════════════════════════════════════════════╝  │
│                                                                      │
│ [PROMPT] Enter your Splunk Cloud stack URL:                        │
│   Example: acme-corp.splunkcloud.com                                │
│   &gt; _______________                                                  │
│                                                                      │
│ Testing connection to https://acme-corp.splunkcloud.com:8089...     │
│ ✓ Splunk Cloud instance reachable                                   │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 2: AUTHENTICATION                                              │
│                                                                      │
│ ╔════════════════════════════════════════════════════════════════╗  │
│ ║  WHY WE ASK:                                                    ║  │
│ ║  REST API access requires authentication. You can use either:   ║  │
│ ║  • Username/Password (your Splunk Cloud login)                  ║  │
│ ║  • API Token (more secure, recommended)                         ║  │
│ ║                                                                 ║  │
│ ║  REQUIRED PERMISSIONS:                                          ║  │
│ ║  • admin_all_objects - Access all knowledge objects             ║  │
│ ║  • list_users, list_roles - Access RBAC data                    ║  │
│ ║  • search - Run analytics queries                               ║  │
│ ╚════════════════════════════════════════════════════════════════╝  │
│                                                                      │
│ [PROMPT] Authentication method:                                      │
│   1. Username/Password                                               │
│   2. API Token (recommended)                                         │
│                                                                      │
│ [If option 1]:                                                       │
│   Enter username: admin                                              │
│   Enter password: ********                                           │
│                                                                      │
│ [If option 2]:                                                       │
│   Enter API token: ********                                          │
│                                                                      │
│ Testing authentication...                                            │
│ ✓ Authentication successful                                         │
│ ✓ User: admin@acme-corp.com                                         │
│ ✓ Capabilities: admin_all_objects, list_users, search               │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 3: ENVIRONMENT DETECTION                                       │
│                                                                      │
│ Detecting Splunk Cloud environment...                                │
│                                                                      │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ Detected Environment:                                          │  │
│ │   Stack: acme-corp.splunkcloud.com                             │  │
│ │   Type: Splunk Cloud Victoria Experience                       │  │
│ │   Version: 9.1.2312                                            │  │
│ │   GUID: ABC123-DEF456-...                                      │  │
│ │   Apps: 45 installed                                           │  │
│ │   Users: 150                                                   │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ [PROMPT] Is this the correct environment? (Y/n)                     │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 4: APPLICATION SELECTION                                       │
│                                                                      │
│ [Same as Enterprise script - list apps, allow selection]            │
│                                                                      │
│   1. Export ALL applications (Recommended)                          │
│   2. Enter specific app names (comma-separated)                     │
│   3. Select from numbered list                                      │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 5: DATA CATEGORIES                                             │
│                                                                      │
│ [Same categories as Enterprise, but note Cloud limitations]         │
│                                                                      │
│ [✓] 1. Configurations (via REST - reconstructed from API)          │
│ [✓] 2. Dashboards (Classic + Dashboard Studio)                      │
│ [✓] 3. Alerts &amp; Saved Searches                                      │
│ [✓] 4. Users &amp; RBAC                                                 │
│ [✓] 5. Usage Analytics (via search on _audit)                       │
│ [✓] 6. Index Statistics                                             │
│ [ ] 7. Lookup Table Contents (may be large)                         │
│                                                                      │
│ Note: Some data may be limited due to Cloud restrictions            │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 6: DATA COLLECTION                                             │
│                                                                      │
│ [1/10] Collecting server information...              ✓              │
│ [2/10] Collecting installed apps...                  ✓              │
│ [3/10] Collecting configurations via REST...         ⏳ 45%         │
│        └─ props.conf (via /configs/conf-props)                      │
│        └─ transforms.conf (via /configs/conf-transforms)            │
│ [4/10] Collecting dashboards...                      ○              │
│ [5/10] Collecting saved searches &amp; alerts...         ○              │
│ [6/10] Collecting users and roles...                 ○              │
│ [7/10] Running usage analytics searches...           ○              │
│ [8/10] Collecting index statistics...                ○              │
│ [9/10] Collecting macros &amp; eventtypes...             ○              │
│ [10/10] Generating summary report...                 ○              │
│                                                                      │
│ Note: Some API calls may be rate-limited. Please be patient.        │
└─────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│ STEP 7: ARCHIVE CREATION &amp; COMPLETION                               │
│                                                                      │
│ Creating compressed archive...                                       │
│ ✓ Archive created: ./dma_cloud_export_acme_20240115.tar.gz  │
│ ✓ Size: 125 MB                                                      │
│                                                                      │
│ NEXT STEPS:                                                         │
│ 1. Upload this file to DMA in Dynatrace                             │
│ 2. The export format is compatible with Enterprise exports          │
└─────────────────────────────────────────────────────────────────────┘</code></pre>
<hr>
<h2>6. Output Structure</h2>
<h3>6.1 Directory Structure</h3>
<p>
The output structure matches the Enterprise export for DMA compatibility:
</p>
<pre><code>dma_cloud_export_[stack]_[timestamp]/
│
├── dma-env-summary.md          # Master summary
├── _metadata.json                      # Export metadata
├── _environment_profile.json           # Cloud environment details
│
├── _systeminfo/
│   ├── server_info.json               # From /services/server/info
│   ├── installed_apps.json            # From /services/apps/local
│   └── license_info.json              # From /services/licenser/licenses
│
├── _rbac/
│   ├── users.json                     # From /services/authentication/users
│   ├── roles.json                     # From /services/authorization/roles
│   └── saml_groups.json               # From /services/admin/SAML-groups
│
├── _usage_analytics/
│   ├── search_activity.json           # From search on _audit
│   ├── dashboard_usage.json           # From search on _internal
│   └── alert_metrics.json             # From search on _audit
│
├── _indexes/
│   └── indexes.json                   # From /services/data/indexes
│
├── _configs/                          # Reconstructed from REST
│   ├── props.json                     # From /configs/conf-props
│   ├── transforms.json                # From /configs/conf-transforms
│   ├── indexes.json                   # From /configs/conf-indexes
│   └── inputs.json                    # From /configs/conf-inputs
│
└── [app_name]/                        # Per-app data (v2 app-centric structure)
    ├── app_info.json                  # App metadata
    ├── dashboards/                    # v2: App-scoped dashboards (v4.2.0+)
    │   ├── classic/                   # Classic XML dashboards for this app
    │   │   └── *.xml
    │   └── studio/                    # Dashboard Studio JSON for this app
    │       └── *.json
    ├── savedsearches.json             # Alerts and saved searches
    ├── macros.json                    # Search macros
    ├── eventtypes.json                # Event types
    ├── tags.json                      # Tags
    ├── lookups/                       # Lookup definitions
    │   ├── lookup_files.json
    │   └── [lookup_name].csv          # If content collection enabled
    └── field_extractions.json         # Field extractions</code></pre>
<h3>6.2 Updated Output Structure (v4.0.0)</h3>
<p>
The v4.0.0 output includes additional usage intelligence files:
</p>
<pre><code>dma_cloud_export_[stack]_[timestamp]/
│
├── manifest.json                         # Standardized metadata schema
├── dma-env-summary.md             # Human-readable summary report
│
├── _usage_analytics/
│   ├── search_activity.json              # Search frequency data
│   ├── dashboard_usage.json              # Dashboard view metrics
│   ├── alert_metrics.json                # Alert trigger statistics
│   ├── dashboard_ownership.json          # Dashboard → owner mapping
│   ├── alert_ownership.json              # Alert → owner mapping
│   ├── ownership_summary.json            # Ownership by user summary
│   ├── top_indexes_by_volume.json        # Volume analysis
│   ├── top_sourcetypes_by_volume.json    # Sourcetype volume data
│   ├── top_hosts_by_volume.json          # Host volume data
│   ├── zero_view_dashboards.json         # Elimination candidates
│   └── never_fired_alerts.json           # Elimination candidates
│
└── [other directories as before]</code></pre>
<hr>
<h2>7. Usage Intelligence</h2>
<h3>7.1 Ownership Mapping</h3>
<p>
The script collects ownership information for user-centric migration planning:
</p>
<pre><code class="language-json">// dashboard_ownership.json
{
  &quot;results&quot;: [
    {
      &quot;dashboard&quot;: &quot;security_overview&quot;,
      &quot;app&quot;: &quot;security_app&quot;,
      &quot;owner&quot;: &quot;security_team&quot;,
      &quot;sharing&quot;: &quot;app&quot;
    }
  ]
}

// alert_ownership.json
{
  &quot;results&quot;: [
    {
      &quot;alert&quot;: &quot;critical_security_alert&quot;,
      &quot;app&quot;: &quot;security_app&quot;,
      &quot;owner&quot;: &quot;security_team&quot;,
      &quot;is_scheduled&quot;: true
    }
  ]
}

// ownership_summary.json
{
  &quot;results&quot;: [
    {
      &quot;owner&quot;: &quot;security_team&quot;,
      &quot;dashboard_count&quot;: 32,
      &quot;alert_count&quot;: 45
    }
  ]
}</code></pre>
<h3>7.2 Volume Analysis</h3>
<p>
Daily ingestion volume analysis for capacity planning:
</p>
<pre><code class="language-json">// top_indexes_by_volume.json
{
  &quot;results&quot;: [
    {
      &quot;index&quot;: &quot;main&quot;,
      &quot;total_gb&quot;: 12.34,
      &quot;event_count&quot;: 123456789
    }
  ]
}

// top_sourcetypes_by_volume.json
{
  &quot;results&quot;: [
    {
      &quot;sourcetype&quot;: &quot;access_combined&quot;,
      &quot;total_gb&quot;: 5.67,
      &quot;event_count&quot;: 45678901
    }
  ]
}</code></pre>
<h3>7.3 Elimination Candidates</h3>
<p>
Identifies unused assets that may be candidates for retirement:
</p>
<p>
<strong>Dashboards with Zero Views:</strong>
</p>
<pre><code class="language-json">// zero_view_dashboards.json
{
  &quot;results&quot;: [
    {
      &quot;dashboard&quot;: &quot;old_unused_dashboard&quot;,
      &quot;app&quot;: &quot;legacy_app&quot;,
      &quot;owner&quot;: &quot;departed_user&quot;,
      &quot;views_30d&quot;: 0
    }
  ]
}</code></pre>
<p>
<strong>Alerts That Never Fired:</strong>
</p>
<pre><code class="language-json">// never_fired_alerts.json
{
  &quot;results&quot;: [
    {
      &quot;alert&quot;: &quot;never_triggered_alert&quot;,
      &quot;app&quot;: &quot;test_app&quot;,
      &quot;owner&quot;: &quot;test_user&quot;,
      &quot;triggers_30d&quot;: 0
    }
  ]
}</code></pre>
<hr>
<h2>8. Manifest Schema</h2>
<h3>8.1 Guaranteed manifest.json Schema</h3>
<p>
The script generates a standardized <code>manifest.json</code> file with a guaranteed schema for DMA consumption:
</p>
<pre><code class="language-json">{
  &quot;schemaVersion&quot;: &quot;4.1.0&quot;,
  &quot;exportType&quot;: &quot;splunk_cloud&quot;,
  &quot;exportTimestamp&quot;: &quot;2025-12-03T10:30:00Z&quot;,
  &quot;scriptVersion&quot;: &quot;4.1.0&quot;,

  &quot;cloudEnvironment&quot;: {
    &quot;stackUrl&quot;: &quot;acme-corp.splunkcloud.com&quot;,
    &quot;stackType&quot;: &quot;victoria&quot;,
    &quot;splunkVersion&quot;: &quot;9.1.2312&quot;,
    &quot;serverGuid&quot;: &quot;ABC123-DEF456-...&quot;,
    &quot;cloudRegion&quot;: &quot;aws-us-west-2&quot;
  },

  &quot;authentication&quot;: {
    &quot;method&quot;: &quot;api_token&quot;,
    &quot;username&quot;: &quot;admin@acme-corp.com&quot;,
    &quot;capabilities&quot;: [&quot;admin_all_objects&quot;, &quot;list_users&quot;, &quot;search&quot;]
  },

  &quot;collection&quot;: {
    &quot;apps&quot;: 45,
    &quot;dashboards&quot;: 245,
    &quot;alerts&quot;: 187,
    &quot;users&quot;: 150,
    &quot;indexes&quot;: 32,
    &quot;apiCallsMade&quot;: 523,
    &quot;rateLimitHits&quot;: 3,
    &quot;errors&quot;: 0,
    &quot;warnings&quot;: 5
  },

  &quot;usageIntelligence&quot;: {
    &quot;analysisPeriod&quot;: &quot;30d&quot;,
    &quot;totalSearches&quot;: 45678,
    &quot;totalDashboardViews&quot;: 12345,
    &quot;totalAlertTriggers&quot;: 4567,
    &quot;topIndexesByVolume&quot;: [...],
    &quot;topSourcetypesByVolume&quot;: [...],
    &quot;topHostsByVolume&quot;: [...],
    &quot;elimination_candidates&quot;: {
      &quot;zeroDashboards&quot;: 12,
      &quot;neverFiredAlerts&quot;: 23
    }
  },

  &quot;exportDuration&quot;: {
    &quot;startTime&quot;: &quot;2025-12-03T10:25:00Z&quot;,
    &quot;endTime&quot;: &quot;2025-12-03T10:32:45Z&quot;,
    &quot;durationSeconds&quot;: 465
  }
}</code></pre>
<h3>8.2 Schema Versioning</h3>
<table>
<thead>
<tr><th>Schema Version</th><th>Script Version</th><th>Key Changes</th></tr>
</thead>
<tbody>
<tr><td>1.0.0</td><td>1.0.0</td><td>Initial schema</td></tr>
<tr><td>3.0.0</td><td>3.0.0</td><td>Added usage analytics</td></tr>
<tr><td>3.5.0</td><td>3.5.0</td><td>Added ownership mapping, elimination candidates, volume analysis</td></tr>
<tr><td>4.0.0</td><td>4.0.0</td><td>Enterprise resilience: paginated APIs, checkpoints, extended timeouts, timing stats</td></tr>
</tbody>
</table>
<hr>
<h2>9. Rate Limiting & Throttling</h2>
<h3>9.1 Splunk Cloud API Limits</h3>
<p>
Splunk Cloud may enforce rate limits on REST API calls:
</p>
<table>
<thead>
<tr><th>Limit Type</th><th>Typical Value</th><th>Handling Strategy</th></tr>
</thead>
<tbody>
<tr><td>Requests per minute</td><td>100-500</td><td>Exponential backoff</td></tr>
<tr><td>Concurrent connections</td><td>10-50</td><td>Sequential processing</td></tr>
<tr><td>Response size</td><td>50MB</td><td>Pagination</td></tr>
<tr><td>Search concurrency</td><td>5-10</td><td>Queue searches</td></tr>
</tbody>
</table>
<h3>9.2 Rate Limit Detection</h3>
<pre><code class="language-bash"># HTTP 429 indicates rate limiting
if [ &quot;$http_code&quot; = &quot;429&quot; ]; then
  retry_after=$(echo &quot;$headers&quot; | grep -i &quot;Retry-After&quot; | cut -d: -f2)
  sleep $retry_after
  # Retry request
fi</code></pre>
<h3>9.3 Throttling Strategy</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                    THROTTLING STRATEGY                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. Start with normal request rate                          │
│                                                              │
│  2. On 429 response:                                        │
│     • Check Retry-After header                              │
│     • Wait specified time (or default 60s)                  │
│     • Reduce request rate by 50%                            │
│     • Retry request                                         │
│                                                              │
│  3. Implement exponential backoff:                          │
│     • 1st retry: wait 1 second                              │
│     • 2nd retry: wait 2 seconds                             │
│     • 3rd retry: wait 4 seconds                             │
│     • Max: wait 60 seconds                                  │
│                                                              │
│  4. For large collections (&gt;1000 items):                    │
│     • Use pagination (count=100, offset=N)                  │
│     • Add 100ms delay between pages                         │
│                                                              │
└─────────────────────────────────────────────────────────────┘</code></pre>
<hr>
<h2>10. Error Handling</h2>
<h3>10.1 Common Errors</h3>
<table>
<thead>
<tr><th>HTTP Code</th><th>Meaning</th><th>Handling</th></tr>
</thead>
<tbody>
<tr><td>401</td><td>Unauthorized</td><td>Check credentials, re-authenticate</td></tr>
<tr><td>403</td><td>Forbidden</td><td>Check capabilities/permissions</td></tr>
<tr><td>404</td><td>Not Found</td><td>Skip resource, log warning</td></tr>
<tr><td>429</td><td>Rate Limited</td><td>Apply backoff, retry</td></tr>
<tr><td>500</td><td>Server Error</td><td>Retry with backoff</td></tr>
<tr><td>503</td><td>Service Unavailable</td><td>Wait, retry</td></tr>
</tbody>
</table>
<h3>10.2 Error Response Format</h3>
<pre><code class="language-json">{
  &quot;errors&quot;: [
    {
      &quot;timestamp&quot;: &quot;2025-12-03T10:32:15Z&quot;,
      &quot;endpoint&quot;: &quot;/servicesNS/-/-/data/ui/views&quot;,
      &quot;httpStatus&quot;: 403,
      &quot;message&quot;: &quot;Capability &#039;admin_all_objects&#039; required&quot;,
      &quot;severity&quot;: &quot;error&quot;,
      &quot;impact&quot;: &quot;Dashboards will not be collected&quot;,
      &quot;resolution&quot;: &quot;Grant &#039;admin_all_objects&#039; to the user/token&quot;
    }
  ],
  &quot;warnings&quot;: [...],
  &quot;skipped&quot;: [...]
}</code></pre>
<h3>10.3 Graceful Degradation</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                   GRACEFUL DEGRADATION                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  If endpoint fails:                                         │
│  1. Log the error with details                              │
│  2. Continue with other endpoints                           │
│  3. Mark that data category as incomplete                   │
│  4. Include error in summary report                         │
│  5. Suggest resolution in final output                      │
│                                                              │
│  Never fail the entire export for a single endpoint error   │
│                                                              │
└─────────────────────────────────────────────────────────────┘</code></pre>
<hr>
<h2>11. Security Considerations</h2>
<h3>11.1 Credential Handling</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                   CREDENTIAL SECURITY                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  DO:                                                        │
│  ✓ Use API tokens instead of passwords when possible        │
│  ✓ Clear credentials from memory after use                  │
│  ✓ Use HTTPS for all API calls                             │
│  ✓ Validate SSL certificates (warn if skipping)            │
│                                                              │
│  DO NOT:                                                    │
│  ✗ Store credentials in the export file                    │
│  ✗ Log credentials in any output                           │
│  ✗ Pass credentials as command-line arguments               │
│  ✗ Store credentials in environment variables permanently   │
│                                                              │
└─────────────────────────────────────────────────────────────┘</code></pre>
<h3>11.2 Data Sensitivity</h3>
<table>
<thead>
<tr><th>Data Type</th><th>Sensitivity</th><th>Handling</th></tr>
</thead>
<tbody>
<tr><td>API Token</td><td>Critical</td><td>Never stored, cleared after use</td></tr>
<tr><td>Password</td><td>Critical</td><td>Never stored, cleared after use</td></tr>
<tr><td>User emails</td><td>Medium</td><td>Collected, marked as PII</td></tr>
<tr><td>User names</td><td>Medium</td><td>Collected, marked as PII</td></tr>
<tr><td>Search queries</td><td>Medium</td><td>May contain sensitive terms</td></tr>
<tr><td>Dashboard names</td><td>Low</td><td>Collected</td></tr>
<tr><td>Index names</td><td>Low</td><td>Collected</td></tr>
</tbody>
</table>
<h3>11.3 Network Security</h3>
<pre><code class="language-bash"># Always use HTTPS
URL=&quot;https://${STACK}.splunkcloud.com:8089&quot;

# Verify SSL certificate (default)
curl &quot;$URL/services/server/info&quot;

# If custom CA or self-signed (warn user)
curl -k &quot;$URL/services/server/info&quot;  # Not recommended</code></pre>
<hr>
<h2>PowerShell Edition</h2>
<h3>Overview</h3>
<p>
<strong><code>dma-splunk-cloud-export.ps1</code></strong> v4.3.0 provides identical export functionality for Windows environments. It requires zero external dependencies -- no Python, no curl, no jq. It uses native PowerShell cmdlets for all operations.
</p>
<ul>
<li><strong>PowerShell 5.1+</strong> (Windows PowerShell, included with Windows 10/Server 2016+)</li>
<li><strong>PowerShell 7+</strong> (cross-platform -- Windows, macOS, Linux)</li>
</ul>
<h3>Parameter Mapping (Bash to PowerShell)</h3>
<table>
<thead>
<tr><th>Bash</th><th>PowerShell</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>--stack URL</code></td><td><code>-Stack URL</code></td><td>Splunk Cloud stack URL</td></tr>
<tr><td><code>--token TOKEN</code></td><td><code>-Token TOKEN</code></td><td>API bearer token</td></tr>
<tr><td><code>--user USER</code></td><td><code>-User USER</code></td><td>Username for basic auth</td></tr>
<tr><td><code>--password PASS</code></td><td><code>-Password PASS</code></td><td>Password for basic auth</td></tr>
<tr><td><code>--all-apps</code></td><td><code>-AllApps</code></td><td>Export all apps</td></tr>
<tr><td><code>--apps LIST</code></td><td><code>-Apps LIST</code></td><td>Comma-separated app names</td></tr>
<tr><td><code>--rbac</code></td><td><code>-Rbac</code></td><td>Enable RBAC collection</td></tr>
<tr><td><code>--usage</code></td><td><code>-Usage</code></td><td>Enable usage analytics collection</td></tr>
<tr><td><code>--scoped</code></td><td><em>(auto)</em></td><td>Auto-scoped when <code>-Apps</code> is specified</td></tr>
<tr><td><code>--skip-internal</code></td><td><code>-SkipInternal</code></td><td>Skip <code>_internal</code> searches</td></tr>
<tr><td><code>--resume-collect FILE</code></td><td><code>-ResumeCollect FILE</code></td><td>Resume from a previous archive</td></tr>
<tr><td><code>--proxy URL</code></td><td><code>-Proxy URL</code></td><td>Route all connections through a proxy server</td></tr>
<tr><td><code>-d, --debug</code></td><td><code>-Debug_Mode</code></td><td>Enable debug logging</td></tr>
<tr><td><code>--output DIR</code></td><td><code>-Output DIR</code></td><td>Output directory</td></tr>
<tr><td><code>--help</code></td><td><code>-ShowHelp</code></td><td>Show help message</td></tr>
</tbody>
</table>
<h3>Key Differences from Bash</h3>
<table>
<thead>
<tr><th>Aspect</th><th>Bash Script</th><th>PowerShell Script</th></tr>
</thead>
<tbody>
<tr><td><strong>HTTP Client</strong></td><td><code>curl</code></td><td><code>Invoke-WebRequest</code> / <code>Invoke-RestMethod</code></td></tr>
<tr><td><strong>JSON Processing</strong></td><td>Python 3 (<code>json</code> module)</td><td><code>ConvertFrom-Json</code> / <code>ConvertTo-Json</code> (native)</td></tr>
<tr><td><strong>Archive Creation</strong></td><td><code>tar</code> (system)</td><td><code>tar.exe</code> (built into Windows 10+)</td></tr>
<tr><td><strong>External Dependencies</strong></td><td>Python 3, curl, tar</td><td>None -- all native PowerShell cmdlets</td></tr>
<tr><td><strong>Platform</strong></td><td>Linux, macOS</td><td>Windows (5.1+), cross-platform (7+)</td></tr>
</tbody>
</table>
<h3>Usage Examples</h3>
<pre><code class="language-powershell"># Token-based authentication (recommended)
.\dma-splunk-cloud-export.ps1 -Stack &quot;acme-corp.splunkcloud.com&quot; -Token &quot;your-api-token&quot; -AllApps

# Username/password authentication with specific apps
.\dma-splunk-cloud-export.ps1 -Stack &quot;acme-corp.splunkcloud.com&quot; -User &quot;admin&quot; -Password &quot;pass&quot; -Apps &quot;search,myapp&quot;

# Resume from previous export
.\dma-splunk-cloud-export.ps1 -Stack &quot;acme-corp.splunkcloud.com&quot; -Token &quot;token&quot; -ResumeCollect &quot;dma_cloud_export_acme_20260115.tar.gz&quot;

# Full export with RBAC and usage analytics
.\dma-splunk-cloud-export.ps1 -Stack &quot;acme-corp.splunkcloud.com&quot; -Token &quot;token&quot; -AllApps -Rbac -Usage</code></pre>
<hr>
<h2>Appendix A: Full API Collection Script Outline</h2>
<pre><code class="language-bash">#!/bin/bash
# dma-splunk-cloud-export.sh

# 1. Parse arguments and show banner
# 2. Get stack URL from user
# 3. Test connectivity
# 4. Get authentication (token or user/pass)
# 5. Test authentication and check capabilities
# 6. Detect environment (version, type)
# 7. List apps and let user select
# 8. Select data categories
# 9. Create output directory
# 10. Collect data via REST API:
#     - Server info
#     - Apps
#     - Configs (props, transforms, etc.)
#     - Dashboards
#     - Saved searches
#     - Users and roles
#     - Macros, eventtypes, tags
#     - Index info
#     - Usage analytics (via search)
# 11. Generate summary
# 12. Create archive
# 13. Cleanup and display next steps</code></pre>
<hr>
<h2>Appendix B: JSON Processing Dependencies</h2>
<h3>Bash Script (<code>dma-splunk-cloud-export.sh</code>)</h3>
<p>
The Bash script uses <strong>Python 3</strong> (not jq) for all JSON processing. Python 3 is typically available on systems where Splunk is installed (Splunk bundles its own Python). The script uses the <code>json</code> module from the Python standard library.
</p>
<pre><code class="language-bash"># The script checks for Python 3 at startup
if command -v python3 &amp;&gt; /dev/null; then
    PYTHON_CMD=&quot;python3&quot;
elif command -v python &amp;&gt; /dev/null; then
    PYTHON_CMD=&quot;python&quot;
fi</code></pre>
<p>
Python 3 is used for:
</p>
<ul>
<li>Parsing REST API JSON responses</li>
<li>Extracting usage intelligence data</li>
<li>Generating and validating manifest.json</li>
<li>Building the ownership mapping files</li>
</ul>
<p>
<strong>Note</strong>: <code>jq</code> is NOT required. Earlier versions of this specification referenced jq, but the script has used Python 3 since v3.6.0.
</p>
<h3>PowerShell Script (<code>dma-splunk-cloud-export.ps1</code>)</h3>
<p>
The PowerShell script uses <strong>native PowerShell cmdlets</strong> for all JSON processing -- no external dependencies are required:
</p>
<ul>
<li><code>ConvertFrom-Json</code> -- parses JSON responses from Splunk REST API</li>
<li><code>ConvertTo-Json</code> -- generates manifest.json and other output files</li>
<li><code>Invoke-WebRequest</code> / <code>Invoke-RestMethod</code> -- HTTP client (replaces curl)</li>
</ul>
<hr>
<p>
<em>End of Splunk Cloud Export Script Technical Specification</em>
<em>Version 4.3.0</em>
</p>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">Dynatrace Migration Assistant</div>
            <p>Migration intelligence for Splunk to Dynatrace Gen3 Grail</p>
            <div class="footer-links">
                <a href="README-SPLUNK-ENTERPRISE.html">Enterprise Guide</a>
                <a href="README-SPLUNK-CLOUD.html">Cloud Guide</a>
                <a href="SCRIPT-GENERATED-ANALYTICS-REFERENCE.html">Analytics</a>
                <a href="EXPORT-SCHEMA.html">Schema</a>
            </div>
            <p class="footer-copyright">DMA Project &bull; Built for Dynatrace Gen3 Platform</p>
        </div>
    </footer>
</body>
</html>
